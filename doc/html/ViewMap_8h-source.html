<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//$LANGUAGE"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Freestyle: ViewMap.h Source File</title>
<link rel="stylesheet" href="grey.css" type="text/css">
</head>
<body>

<b>
<table width='100%' border='0' cellspacing='0' cellpadding='0'>
<tr>
<td align='center'><a href="http://freestyle.sourceforge.net">h<font class="brighttitle"> o m e</font></a></td>
<td align='center'><a href="index.html">d<font class="brighttitle"> o c u m e n t a t i o n</font></a></td>
<td align='center'><a href="hierarchy.html">c<font class="brighttitle"> l a s s   </font>h <font class="brighttitle"> i e r a r c h y</font></a></td>
</tr>
</table>
<div class="brighttitle"><hr/></div>
</b>
<div class="corpus">
<!-- Generated by Doxygen 1.5.1 -->
<h1>ViewMap.h</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//</span>
<a name="l00002"></a>00002 <span class="comment">//  Filename         : ViewMap.h</span>
<a name="l00003"></a>00003 <span class="comment">//  Author(s)        : Stephane Grabli</span>
<a name="l00004"></a>00004 <span class="comment">//  Purpose          : Classes to define a View Map (ViewVertex, ViewEdge, etc.)</span>
<a name="l00005"></a>00005 <span class="comment">//  Date of creation : 03/09/2002</span>
<a name="l00006"></a>00006 <span class="comment">//</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="comment">//</span>
<a name="l00011"></a>00011 <span class="comment">//  Copyright (C) : Please refer to the COPYRIGHT file distributed </span>
<a name="l00012"></a>00012 <span class="comment">//   with this source distribution. </span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">//  This program is free software; you can redistribute it and/or</span>
<a name="l00015"></a>00015 <span class="comment">//  modify it under the terms of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment">//  as published by the Free Software Foundation; either version 2</span>
<a name="l00017"></a>00017 <span class="comment">//  of the License, or (at your option) any later version.</span>
<a name="l00018"></a>00018 <span class="comment">//</span>
<a name="l00019"></a>00019 <span class="comment">//  This program is distributed in the hope that it will be useful,</span>
<a name="l00020"></a>00020 <span class="comment">//  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00021"></a>00021 <span class="comment">//  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00022"></a>00022 <span class="comment">//  GNU General Public License for more details.</span>
<a name="l00023"></a>00023 <span class="comment">//</span>
<a name="l00024"></a>00024 <span class="comment">//  You should have received a copy of the GNU General Public License</span>
<a name="l00025"></a>00025 <span class="comment">//  along with this program; if not, write to the Free Software</span>
<a name="l00026"></a>00026 <span class="comment">//  Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<a name="l00027"></a>00027 <span class="comment">//</span>
<a name="l00029"></a>00029 <span class="comment"></span>
<a name="l00030"></a>00030 <span class="preprocessor">#ifndef  VIEWMAP_H</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor"># define VIEWMAP_H</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor"># include "../system/BaseIterator.h"</span>
<a name="l00034"></a>00034 <span class="preprocessor"># include "../system/FreestyleConfig.h"</span>
<a name="l00035"></a>00035 <span class="preprocessor"># include "../geometry/GeomUtils.h"</span>
<a name="l00036"></a>00036 <span class="preprocessor"># include "Interface0D.h"</span>
<a name="l00037"></a>00037 <span class="preprocessor"># include "<a class="code" href="Interface1D_8h.html">Interface1D.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor"># include "Silhouette.h"</span> <span class="comment">// defines the embedding</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040                   <span class="comment">/**********************************/</span>
<a name="l00041"></a>00041                   <span class="comment">/*                                */</span>
<a name="l00042"></a>00042                   <span class="comment">/*                                */</span>
<a name="l00043"></a>00043                   <span class="comment">/*             ViewMap            */</span>
<a name="l00044"></a>00044                   <span class="comment">/*                                */</span>
<a name="l00045"></a>00045                   <span class="comment">/*                                */</span>
<a name="l00046"></a>00046                   <span class="comment">/**********************************/</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="comment">/*  Density</span>
<a name="l00050"></a>00050 <span class="comment">    Mean area depth value</span>
<a name="l00051"></a>00051 <span class="comment">    distance to a point</span>
<a name="l00052"></a>00052 <span class="comment">    */</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="keyword">class </span><a class="code" href="classViewVertex.html">ViewVertex</a>;
<a name="l00055"></a>00055 <span class="keyword">class </span><a class="code" href="classViewEdge.html">ViewEdge</a>;
<a name="l00056"></a>00056 <span class="keyword">class </span><a class="code" href="classViewShape.html">ViewShape</a>;
<a name="l00057"></a>00057 <span class="keyword">class </span><a class="code" href="classTVertex.html">TVertex</a>;
<a name="l00058"></a>00058 
<a name="l00060"></a><a class="code" href="classViewMap.html">00060</a> <span class="keyword">class </span>LIB_VIEW_MAP_EXPORT <a class="code" href="classViewMap.html">ViewMap</a> 
<a name="l00061"></a>00061 {
<a name="l00062"></a>00062 <span class="keyword">public</span>:
<a name="l00063"></a>00063 
<a name="l00064"></a>00064   <span class="keyword">typedef</span> vector&lt;ViewEdge*&gt; viewedges_container;
<a name="l00065"></a>00065   <span class="keyword">typedef</span> vector&lt;ViewVertex*&gt; viewvertices_container;
<a name="l00066"></a>00066   <span class="keyword">typedef</span> vector&lt;ViewShape*&gt; viewshapes_container;
<a name="l00067"></a>00067   <span class="keyword">typedef</span> vector&lt;SVertex*&gt; svertices_container;
<a name="l00068"></a>00068   <span class="keyword">typedef</span> vector&lt;FEdge*&gt; fedges_container;
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="keyword">private</span>:
<a name="l00071"></a>00071 
<a name="l00072"></a>00072   <span class="keyword">static</span> <a class="code" href="classViewMap.html">ViewMap</a> *_pInstance;
<a name="l00073"></a>00073   viewshapes_container _VShapes; <span class="comment">// view shapes</span>
<a name="l00074"></a>00074   viewedges_container _VEdges; <span class="comment">// view edges</span>
<a name="l00075"></a>00075   viewvertices_container _VVertices; <span class="comment">// view vertices</span>
<a name="l00076"></a>00076   fedges_container _FEdges; <span class="comment">// feature edges (embedded edges)</span>
<a name="l00077"></a>00077   svertices_container _SVertices; <span class="comment">// embedded vertices</span>
<a name="l00078"></a>00078   BBox&lt;Vec3r&gt; _scene3DBBox;
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="keyword">public</span>:
<a name="l00081"></a>00081 
<a name="l00085"></a><a class="code" href="classViewMap.html#fd0ffb02780e738d4c0a10ab833b7834">00085</a>   <span class="keywordtype">void</span>* userdata;
<a name="l00086"></a>00086 
<a name="l00088"></a><a class="code" href="classViewMap.html#1ec56e011eb168594e9359571b257508">00088</a>   <a class="code" href="classViewMap.html">ViewMap</a>() {
<a name="l00089"></a>00089     _pInstance = <span class="keyword">this</span>;
<a name="l00090"></a>00090     userdata = 0;
<a name="l00091"></a>00091   }
<a name="l00093"></a>00093   <span class="keyword">virtual</span> ~<a class="code" href="classViewMap.html">ViewMap</a>();
<a name="l00094"></a>00094 
<a name="l00098"></a>00098   <span class="keyword">const</span> <a class="code" href="classViewEdge.html">ViewEdge</a> * GetClosestViewEdge(real x, real y) <span class="keyword">const </span>;
<a name="l00099"></a>00099 
<a name="l00103"></a>00103   <span class="keyword">const</span> <a class="code" href="classFEdge.html">FEdge</a> * GetClosestFEdge(real x, real y) <span class="keyword">const </span>;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="comment">/* accessors */</span>
<a name="l00109"></a><a class="code" href="classViewMap.html#a59835e0b980e7b42a7aa21d11fbba30">00109</a>   <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="classViewMap.html">ViewMap</a> * getInstance() {<span class="keywordflow">return</span> _pInstance;}
<a name="l00110"></a>00110   <span class="comment">/* Returns the list of ViewShapes of the scene. */</span>
<a name="l00111"></a>00111   <span class="keyword">inline</span> viewshapes_container&amp; ViewShapes() {<span class="keywordflow">return</span> _VShapes;}
<a name="l00112"></a>00112   <span class="comment">/* Returns the list of ViewEdges of the scene. */</span>
<a name="l00113"></a>00113   <span class="keyword">inline</span> viewedges_container&amp; ViewEdges() {<span class="keywordflow">return</span> _VEdges;}
<a name="l00114"></a>00114   <span class="comment">/* Returns the list of ViewVertices of the scene. */</span>
<a name="l00115"></a>00115   <span class="keyword">inline</span> viewvertices_container&amp; ViewVertices() {<span class="keywordflow">return</span> _VVertices;}
<a name="l00116"></a>00116   <span class="comment">/* Returns the list of FEdges of the scene. */</span>
<a name="l00117"></a>00117   <span class="keyword">inline</span> fedges_container&amp; FEdges() {<span class="keywordflow">return</span> _FEdges;}
<a name="l00118"></a>00118   <span class="comment">/* Returns the list of SVertices of the scene. */</span>
<a name="l00119"></a>00119   <span class="keyword">inline</span> svertices_container&amp; SVertices() {<span class="keywordflow">return</span> _SVertices;}
<a name="l00120"></a>00120   <span class="comment">/* Returns an iterator pointing onto the first ViewEdge of the list. */</span>
<a name="l00121"></a>00121   <span class="keyword">inline</span> viewedges_container::iterator viewedges_begin() {<span class="keywordflow">return</span> _VEdges.begin();}
<a name="l00122"></a>00122   <span class="keyword">inline</span> viewedges_container::iterator viewedges_end() {<span class="keywordflow">return</span> _VEdges.end();}
<a name="l00123"></a>00123   <span class="keyword">inline</span> <span class="keywordtype">int</span> viewedges_size() {<span class="keywordflow">return</span> _VEdges.size();}
<a name="l00124"></a>00124   <a class="code" href="classViewShape.html">ViewShape</a> * viewShape(<span class="keywordtype">unsigned</span> index);
<a name="l00126"></a><a class="code" href="classViewMap.html#6c8e912c5ab67a70a20aecee1fd2bf95">00126</a>   <span class="keyword">inline</span> BBox&lt;Vec3r&gt; getScene3dBBox()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _scene3DBBox;}
<a name="l00127"></a>00127 
<a name="l00128"></a>00128   <span class="comment">/* modifiers */</span>
<a name="l00129"></a>00129   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddViewShape(<a class="code" href="classViewShape.html">ViewShape</a> *iVShape) {_VShapes.push_back(iVShape);}
<a name="l00130"></a>00130   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddViewEdge(<a class="code" href="classViewEdge.html">ViewEdge</a> *iVEdge) {_VEdges.push_back(iVEdge);}
<a name="l00131"></a>00131   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddViewVertex(<a class="code" href="classViewVertex.html">ViewVertex</a> *iVVertex) {_VVertices.push_back(iVVertex);}
<a name="l00132"></a>00132   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddFEdge(<a class="code" href="classFEdge.html">FEdge</a> *iFEdge) {_FEdges.push_back(iFEdge);}
<a name="l00133"></a>00133   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddSVertex(<a class="code" href="classSVertex.html">SVertex</a> *iSVertex) {_SVertices.push_back(iSVertex);}
<a name="l00135"></a><a class="code" href="classViewMap.html#f2b6e12b61fb16251d31945a89853fc3">00135</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> setScene3dBBox(<span class="keyword">const</span> BBox&lt;Vec3r&gt;&amp; bbox) {_scene3DBBox=bbox;}
<a name="l00136"></a>00136 
<a name="l00137"></a>00137   <span class="comment">/* Creates a T vertex in the view map.</span>
<a name="l00138"></a>00138 <span class="comment">   *  A T vertex is the intersection between 2</span>
<a name="l00139"></a>00139 <span class="comment">   *  FEdges (before these ones are splitted).</span>
<a name="l00140"></a>00140 <span class="comment">   *  The TVertex is a 2D intersection but it </span>
<a name="l00141"></a>00141 <span class="comment">   *  corresponds to a 3D point on each of the 2 FEdges.</span>
<a name="l00142"></a>00142 <span class="comment">   *    iA3D</span>
<a name="l00143"></a>00143 <span class="comment">   *      The 3D coordinates of the point corresponding </span>
<a name="l00144"></a>00144 <span class="comment">   *      to the intersection on the first edge.</span>
<a name="l00145"></a>00145 <span class="comment">   *    iA2D</span>
<a name="l00146"></a>00146 <span class="comment">   *      The x,y,z 2D coordinates of the projection </span>
<a name="l00147"></a>00147 <span class="comment">   *      of iA3D</span>
<a name="l00148"></a>00148 <span class="comment">   *    iFEdgeA</span>
<a name="l00149"></a>00149 <span class="comment">   *      The first FEdge</span>
<a name="l00150"></a>00150 <span class="comment">   *    iB3D</span>
<a name="l00151"></a>00151 <span class="comment">   *      The 3D coordinates of the point corresponding </span>
<a name="l00152"></a>00152 <span class="comment">   *      to the intersection on the second edge.</span>
<a name="l00153"></a>00153 <span class="comment">   *    iB2D</span>
<a name="l00154"></a>00154 <span class="comment">   *      The x,y,z 2D coordinates of the projection </span>
<a name="l00155"></a>00155 <span class="comment">   *      of iB3D</span>
<a name="l00156"></a>00156 <span class="comment">   *    iFEdgeB</span>
<a name="l00157"></a>00157 <span class="comment">   *      The second FEdge   </span>
<a name="l00158"></a>00158 <span class="comment">   *    id</span>
<a name="l00159"></a>00159 <span class="comment">   *      The id that must be given to that TVertex</span>
<a name="l00160"></a>00160 <span class="comment">   */</span>
<a name="l00161"></a>00161   <a class="code" href="classTVertex.html">TVertex</a>* CreateTVertex(<span class="keyword">const</span> Vec3r&amp; iA3D, <span class="keyword">const</span> Vec3r&amp; iA2D, <a class="code" href="classFEdge.html">FEdge</a> *iFEdgeA,
<a name="l00162"></a>00162                          <span class="keyword">const</span> Vec3r&amp; iB3D, <span class="keyword">const</span> Vec3r&amp; iB2D, <a class="code" href="classFEdge.html">FEdge</a> *iFEdgeB,
<a name="l00163"></a>00163                          <span class="keyword">const</span> <a class="code" href="classId.html">Id</a>&amp; <span class="keywordtype">id</span>);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165   <span class="comment">/* Updates the structures to take into account the fact </span>
<a name="l00166"></a>00166 <span class="comment">   *  that a SVertex must now be considered as a ViewVertex </span>
<a name="l00167"></a>00167 <span class="comment">   *    iVertex</span>
<a name="l00168"></a>00168 <span class="comment">   *      The SVertex on top of which the ViewVertex is built (it is necessarily</span>
<a name="l00169"></a>00169 <span class="comment">   *      a NonTVertex because it is a SVertex)</span>
<a name="l00170"></a>00170 <span class="comment">   *    newViewEdges</span>
<a name="l00171"></a>00171 <span class="comment">   *      The new ViewEdges that must be add to the ViewMap</span>
<a name="l00172"></a>00172 <span class="comment">   */</span>
<a name="l00173"></a>00173   <a class="code" href="classViewVertex.html">ViewVertex</a> * InsertViewVertex(<a class="code" href="classSVertex.html">SVertex</a> *iVertex, vector&lt;ViewEdge*&gt;&amp; newViewEdges);
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   <span class="comment">/* connects a FEdge to the graph trough a SVertex */</span>
<a name="l00176"></a>00176   <span class="comment">//FEdge * Connect(FEdge *ioEdge, SVertex *ioVertex);</span>
<a name="l00177"></a>00177 };
<a name="l00178"></a>00178 
<a name="l00179"></a>00179                   <span class="comment">/**********************************/</span>
<a name="l00180"></a>00180                   <span class="comment">/*                                */</span>
<a name="l00181"></a>00181                   <span class="comment">/*                                */</span>
<a name="l00182"></a>00182                   <span class="comment">/*             ViewVertex         */</span>
<a name="l00183"></a>00183                   <span class="comment">/*                                */</span>
<a name="l00184"></a>00184                   <span class="comment">/*                                */</span>
<a name="l00185"></a>00185                   <span class="comment">/**********************************/</span>
<a name="l00186"></a>00186 
<a name="l00187"></a>00187 <span class="keyword">class </span><a class="code" href="classViewEdge.html">ViewEdge</a>;
<a name="l00188"></a>00188 <span class="keyword">class </span><a class="code" href="classSShape.html">SShape</a>;
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="keyword">namespace </span>ViewVertexInternal {
<a name="l00191"></a>00191   <span class="keyword">class </span>edge_const_traits;
<a name="l00192"></a>00192   <span class="keyword">class </span>edge_nonconst_traits;
<a name="l00193"></a>00193   <span class="keyword">template</span>&lt;<span class="keyword">class</span> Traits&gt; <span class="keyword">class </span>edge_iterator_base ;
<a name="l00194"></a>00194   <span class="keyword">class </span>orientedViewEdgeIterator;
<a name="l00195"></a>00195 } <span class="comment">// end of namespace ViewEdgeInternal</span>
<a name="l00208"></a><a class="code" href="classViewVertex.html">00208</a> <span class="comment"></span><span class="keyword">class </span>LIB_VIEW_MAP_EXPORT ViewVertex : <span class="keyword">public</span> <a class="code" href="classInterface0D.html">Interface0D</a>
<a name="l00209"></a>00209 {
<a name="l00210"></a>00210 <span class="keyword">public</span>: <span class="comment">// Implementation of Interface0D</span>
<a name="l00211"></a>00211 
<a name="l00213"></a><a class="code" href="classViewVertex.html#002b7eb8fd08613c974586b621ff2636">00213</a>   <span class="keyword">virtual</span> string <a class="code" href="classInterface0D.html#002b7eb8fd08613c974586b621ff2636">getExactTypeName</a>()<span class="keyword"> const </span>{
<a name="l00214"></a>00214     <span class="keywordflow">return</span> <span class="stringliteral">"ViewVertex"</span>;
<a name="l00215"></a>00215   }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="keyword">public</span>:  
<a name="l00218"></a>00218   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classViewShape.html">ViewShape</a>;
<a name="l00219"></a>00219   <span class="keyword">typedef</span> pair&lt;ViewEdge*, bool&gt; directedViewEdge; <span class="comment">// if bool = true, the ViewEdge is incoming</span>
<a name="l00220"></a>00220 
<a name="l00221"></a>00221   <span class="keyword">typedef</span> vector&lt;directedViewEdge&gt; edges_container;
<a name="l00222"></a>00222 
<a name="l00223"></a>00223   <span class="keyword">typedef</span> ViewVertexInternal::edge_iterator_base&lt;ViewVertexInternal::edge_nonconst_traits&gt; edge_iterator;
<a name="l00224"></a>00224   <span class="keyword">typedef</span> ViewVertexInternal::edge_iterator_base&lt;ViewVertexInternal::edge_const_traits&gt; const_edge_iterator;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226 <span class="keyword">private</span>:
<a name="l00227"></a>00227 
<a name="l00228"></a>00228   Nature::VertexNature _Nature;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="keyword">public</span>:
<a name="l00234"></a><a class="code" href="classViewVertex.html#fd0ffb02780e738d4c0a10ab833b7834">00234</a>   <span class="keywordtype">void</span> * <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a>;
<a name="l00236"></a><a class="code" href="classViewVertex.html#a7fa3d0b041b0bc0d1b6d34c24499bb3">00236</a>   <span class="keyword">inline</span> ViewVertex() {<a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;_Nature = Nature::VIEW_VERTEX; }
<a name="l00237"></a>00237   <span class="keyword">inline</span> ViewVertex(Nature::VertexNature nature) {
<a name="l00238"></a>00238     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00239"></a>00239     _Nature = Nature::VIEW_VERTEX | nature;
<a name="l00240"></a>00240   }
<a name="l00241"></a>00241 
<a name="l00242"></a>00242 <span class="keyword">protected</span>:
<a name="l00244"></a><a class="code" href="classViewVertex.html#55d925330cd035b1a18ddecb9bb624b3">00244</a>   <span class="keyword">inline</span> ViewVertex(ViewVertex&amp; iBrother)
<a name="l00245"></a>00245   {
<a name="l00246"></a>00246     _Nature = iBrother.<a class="code" href="classViewVertex.html#f386e76163c63f3cddcbd9753ea9599d">_Nature</a>;
<a name="l00247"></a>00247     iBrother.<a class="code" href="classViewVertex.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = <span class="keyword">this</span>;
<a name="l00248"></a>00248     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00249"></a>00249   }
<a name="l00251"></a>00251   <span class="keyword">virtual</span> ViewVertex * <a class="code" href="classViewShape.html#fe290800451bb1e53bf66d442a8a983e">dupplicate</a>() = 0;
<a name="l00252"></a>00252   
<a name="l00253"></a>00253 <span class="keyword">public</span>:
<a name="l00255"></a><a class="code" href="classViewVertex.html#c757fd6d2425de6345e0cb30bf7aa11e">00255</a>   <span class="keyword">virtual</span> ~ViewVertex() {}
<a name="l00256"></a>00256 
<a name="l00257"></a>00257   <span class="comment">/* accessors */</span>
<a name="l00259"></a><a class="code" href="classViewVertex.html#643d426a4acc50f3a531e054ec8f5b42">00259</a>   <span class="keyword">virtual</span> Nature::VertexNature <a class="code" href="classInterface0D.html#643d426a4acc50f3a531e054ec8f5b42">getNature</a>()<span class="keyword"> const </span>{
<a name="l00260"></a>00260     <span class="keywordflow">return</span> _Nature;
<a name="l00261"></a>00261   }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   <span class="comment">/* modifiers */</span>
<a name="l00265"></a><a class="code" href="classViewVertex.html#bbe18d1308f6210cedd9b16df547b79b">00265</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> setNature(Nature::VertexNature iNature) {_Nature = iNature;}
<a name="l00266"></a>00266   
<a name="l00267"></a>00267   <span class="comment">/* Replaces old edge by new edge */</span>
<a name="l00268"></a>00268   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Replace(<a class="code" href="classViewEdge.html">ViewEdge</a> *, <a class="code" href="classViewEdge.html">ViewEdge</a> *) {}
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="keyword">public</span>:
<a name="l00271"></a>00271   
<a name="l00272"></a>00272   <span class="comment">/* iterators access */</span>
<a name="l00273"></a>00273   <span class="comment">// allows iteration on the edges that comes from/goes to </span>
<a name="l00274"></a>00274   <span class="comment">// this vertex in CCW order (order defined in 2D in the image plan)</span>
<a name="l00275"></a>00275   <span class="keyword">virtual</span> edge_iterator edges_begin() = 0;
<a name="l00276"></a>00276   <span class="keyword">virtual</span> const_edge_iterator edges_begin() <span class="keyword">const </span>= 0;
<a name="l00277"></a>00277   <span class="keyword">virtual</span> edge_iterator edges_end()   = 0;
<a name="l00278"></a>00278   <span class="keyword">virtual</span> const_edge_iterator edges_end() <span class="keyword">const   </span>= 0;
<a name="l00279"></a>00279   <span class="keyword">virtual</span> edge_iterator edges_iterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) = 0;
<a name="l00280"></a>00280   <span class="keyword">virtual</span> const_edge_iterator edges_iterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) <span class="keyword">const </span>= 0;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   <span class="comment">// Iterator access</span>
<a name="l00288"></a>00288 <span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> edgesBegin() = 0;
<a name="l00292"></a>00292   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> edgesEnd() = 0;
<a name="l00296"></a>00296   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> edgesIterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) = 0;
<a name="l00297"></a>00297   
<a name="l00298"></a>00298 };
<a name="l00299"></a>00299 
<a name="l00300"></a>00300                   <span class="comment">/**********************************/</span>
<a name="l00301"></a>00301                   <span class="comment">/*                                */</span>
<a name="l00302"></a>00302                   <span class="comment">/*                                */</span>
<a name="l00303"></a>00303                   <span class="comment">/*             TVertex            */</span>
<a name="l00304"></a>00304                   <span class="comment">/*                                */</span>
<a name="l00305"></a>00305                   <span class="comment">/*                                */</span>
<a name="l00306"></a>00306                   <span class="comment">/**********************************/</span>
<a name="l00307"></a>00307 
<a name="l00316"></a><a class="code" href="classTVertex.html">00316</a> <span class="keyword">class </span>LIB_VIEW_MAP_EXPORT TVertex : <span class="keyword">public</span> ViewVertex
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318 <span class="keyword">public</span>:
<a name="l00319"></a>00319   <span class="keyword">typedef</span> vector&lt;directedViewEdge*&gt; edge_pointers_container;
<a name="l00320"></a>00320 <span class="keyword">public</span>: <span class="comment">// Implementation of Interface0D</span>
<a name="l00321"></a>00321 
<a name="l00323"></a><a class="code" href="classTVertex.html#002b7eb8fd08613c974586b621ff2636">00323</a>   <span class="keyword">virtual</span> string <a class="code" href="classViewVertex.html#002b7eb8fd08613c974586b621ff2636">getExactTypeName</a>()<span class="keyword"> const </span>{
<a name="l00324"></a>00324     <span class="keywordflow">return</span> <span class="stringliteral">"TVertex"</span>;
<a name="l00325"></a>00325   }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327   <span class="comment">// Data access methods</span>
<a name="l00328"></a>00328   <span class="comment">/* Returns the 3D x coordinate of the vertex .</span>
<a name="l00329"></a>00329 <span class="comment">   * Ambiguous in this case.</span>
<a name="l00330"></a>00330 <span class="comment">   */</span>
<a name="l00331"></a><a class="code" href="classTVertex.html#274823147ae3fafce59cbe9fb6dec08a">00331</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#274823147ae3fafce59cbe9fb6dec08a">getX</a>()<span class="keyword"> const </span>{
<a name="l00332"></a>00332     cerr &lt;&lt; <span class="stringliteral">"Warning: getX() undefined for this point"</span> &lt;&lt; endl;
<a name="l00333"></a>00333     <span class="keywordflow">return</span> _FrontSVertex-&gt;point3D().x();
<a name="l00334"></a>00334   }
<a name="l00335"></a>00335 
<a name="l00336"></a><a class="code" href="classTVertex.html#f7e41b0ea9c10ae3bb6ffba615a82628">00336</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#f7e41b0ea9c10ae3bb6ffba615a82628">getY</a>()<span class="keyword"> const </span>{
<a name="l00337"></a>00337     cerr &lt;&lt; <span class="stringliteral">"Warning: getX() undefined for this point"</span> &lt;&lt; endl;
<a name="l00338"></a>00338     <span class="keywordflow">return</span> _FrontSVertex-&gt;point3D().y();
<a name="l00339"></a>00339   }
<a name="l00340"></a>00340 
<a name="l00341"></a><a class="code" href="classTVertex.html#054421e6b566c6b515370982bbabbaef">00341</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#054421e6b566c6b515370982bbabbaef">getZ</a>()<span class="keyword"> const </span>{
<a name="l00342"></a>00342     cerr &lt;&lt; <span class="stringliteral">"Warning: getX() undefined for this point"</span> &lt;&lt; endl;
<a name="l00343"></a>00343     <span class="keywordflow">return</span> _FrontSVertex-&gt;point3D().z();
<a name="l00344"></a>00344   }
<a name="l00345"></a>00345 
<a name="l00347"></a><a class="code" href="classTVertex.html#a63f0103f8f30be8036639e5d7cf25b4">00347</a>   <span class="keyword">virtual</span> Vec3f <a class="code" href="classInterface0D.html#4f6735c8455c5abc8ef0b6fcd47043df">getPoint3D</a>()<span class="keyword"> const </span>{
<a name="l00348"></a>00348     cerr &lt;&lt; <span class="stringliteral">"Warning: getPoint3D() undefined for this point"</span> &lt;&lt; endl;
<a name="l00349"></a>00349     <span class="keywordflow">return</span> _FrontSVertex-&gt;getPoint3D();
<a name="l00350"></a>00350   }
<a name="l00351"></a>00351 
<a name="l00353"></a><a class="code" href="classTVertex.html#63f087d35a11d5c70d60ad8afec7643a">00353</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#63f087d35a11d5c70d60ad8afec7643a">getProjectedX</a>()<span class="keyword"> const </span>{
<a name="l00354"></a>00354     <span class="keywordflow">return</span> _FrontSVertex-&gt;point2D().x();
<a name="l00355"></a>00355   }
<a name="l00356"></a>00356 
<a name="l00358"></a><a class="code" href="classTVertex.html#d7dd5911b8a5c6631001e380fcc83b99">00358</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#d7dd5911b8a5c6631001e380fcc83b99">getProjectedY</a>()<span class="keyword"> const </span>{
<a name="l00359"></a>00359     <span class="keywordflow">return</span> _FrontSVertex-&gt;point2D().y();
<a name="l00360"></a>00360   }
<a name="l00361"></a>00361 
<a name="l00362"></a><a class="code" href="classTVertex.html#873f09cb4e7b1a4da69d7310686b57f0">00362</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#873f09cb4e7b1a4da69d7310686b57f0">getProjectedZ</a>()<span class="keyword"> const </span>{
<a name="l00363"></a>00363     <span class="keywordflow">return</span> _FrontSVertex-&gt;point2D().z();
<a name="l00364"></a>00364   }
<a name="l00365"></a>00365 
<a name="l00367"></a><a class="code" href="classTVertex.html#d1dd891e64a6b7c555bc0f7a6b61f809">00367</a>   <span class="keyword">virtual</span> Vec2f <a class="code" href="classInterface0D.html#387721134bb87d1fc375cd0416815e8d">getPoint2D</a>()<span class="keyword"> const </span>{
<a name="l00368"></a>00368     <span class="keywordflow">return</span> _FrontSVertex-&gt;getPoint2D();
<a name="l00369"></a>00369   }
<a name="l00370"></a>00370 
<a name="l00372"></a><a class="code" href="classTVertex.html#67c9cf6326a694c4b411a2b32c90c56f">00372</a>   <span class="keyword">virtual</span> <a class="code" href="classId.html">Id</a> <a class="code" href="classInterface0D.html#67c9cf6326a694c4b411a2b32c90c56f">getId</a>()<span class="keyword"> const </span>{
<a name="l00373"></a>00373     <span class="keywordflow">return</span> _Id;
<a name="l00374"></a>00374   }
<a name="l00375"></a>00375 
<a name="l00377"></a>00377   <span class="comment">// it can't</span>
<a name="l00379"></a><a class="code" href="classTVertex.html#a3037f6ca1e9a4d67b6b707e595db5d1">00379</a> <span class="comment"></span>  <span class="keyword">virtual</span> ViewVertex * <a class="code" href="classInterface0D.html#a3037f6ca1e9a4d67b6b707e595db5d1">castToViewVertex</a>(){
<a name="l00380"></a>00380     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00381"></a>00381   }
<a name="l00382"></a>00382 
<a name="l00384"></a><a class="code" href="classTVertex.html#d4f4e2d1e4a3f8cff0e67e8a4ec98996">00384</a>   <span class="keyword">virtual</span> TVertex * <a class="code" href="classInterface0D.html#d4f4e2d1e4a3f8cff0e67e8a4ec98996">castToTVertex</a>(){
<a name="l00385"></a>00385     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00386"></a>00386   }
<a name="l00387"></a>00387 
<a name="l00388"></a>00388 <span class="keyword">private</span>:
<a name="l00389"></a>00389   <a class="code" href="classSVertex.html">SVertex</a>  *_FrontSVertex;
<a name="l00390"></a>00390   <a class="code" href="classSVertex.html">SVertex</a>  *_BackSVertex;
<a name="l00391"></a>00391   directedViewEdge _FrontEdgeA;
<a name="l00392"></a>00392   directedViewEdge _FrontEdgeB;
<a name="l00393"></a>00393   directedViewEdge _BackEdgeA;
<a name="l00394"></a>00394   directedViewEdge _BackEdgeB;
<a name="l00395"></a>00395   <a class="code" href="classId.html">Id</a> _Id; <span class="comment">// id to identify t vertices . these id will be negative in order not to be mixed with NonTVertex ids.</span>
<a name="l00396"></a>00396   edge_pointers_container _sortedEdges; <span class="comment">// the list of the four ViewEdges, ordered in CCW order (in the image plan)</span>
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="keyword">public</span>:
<a name="l00401"></a><a class="code" href="classTVertex.html#4f78f3fac3e3d623732b1eacc8314b47">00401</a>   <span class="keyword">inline</span> TVertex() : ViewVertex(Nature::T_VERTEX) 
<a name="l00402"></a>00402   {
<a name="l00403"></a>00403     _FrontSVertex = 0;
<a name="l00404"></a>00404     _BackSVertex = 0;
<a name="l00405"></a>00405     _FrontEdgeA.first = 0;
<a name="l00406"></a>00406     _FrontEdgeB.first = 0;
<a name="l00407"></a>00407     _BackEdgeA.first = 0;
<a name="l00408"></a>00408     _BackEdgeB.first = 0;
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="keyword">inline</span> TVertex(<a class="code" href="classSVertex.html">SVertex</a> *svFront, <a class="code" href="classSVertex.html">SVertex</a> *svBack)
<a name="l00413"></a>00413     : ViewVertex(Nature::T_VERTEX)
<a name="l00414"></a>00414   {
<a name="l00415"></a>00415     _FrontSVertex = svFront;
<a name="l00416"></a>00416     _BackSVertex = svBack;
<a name="l00417"></a>00417     _FrontEdgeA.first = 0;
<a name="l00418"></a>00418     _FrontEdgeB.first = 0;
<a name="l00419"></a>00419     _BackEdgeA.first = 0;
<a name="l00420"></a>00420     _BackEdgeB.first = 0;
<a name="l00421"></a>00421     svFront-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);
<a name="l00422"></a>00422     svBack-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);
<a name="l00423"></a>00423   }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="keyword">protected</span>:
<a name="l00427"></a><a class="code" href="classTVertex.html#51ec5d63017a74c7aed9cf934eba24ab">00427</a>   <span class="keyword">inline</span> TVertex(TVertex&amp; iBrother)
<a name="l00428"></a>00428     : ViewVertex(iBrother)
<a name="l00429"></a>00429   {
<a name="l00430"></a>00430     _FrontSVertex = iBrother.<a class="code" href="classTVertex.html#6b3a2c2b6badc7ff5bb358df055035d5">_FrontSVertex</a>;
<a name="l00431"></a>00431     _BackSVertex = iBrother.<a class="code" href="classTVertex.html#2f8a6a98a8c68114b37690bcee06a8e4">_BackSVertex</a>;
<a name="l00432"></a>00432     _FrontEdgeA = iBrother.<a class="code" href="classTVertex.html#d2ca3811dd8a57ab43ecb9dfcc3d0b46">_FrontEdgeA</a>;
<a name="l00433"></a>00433     _FrontEdgeB = iBrother.<a class="code" href="classTVertex.html#9f24ce6aefb6935701902f1f19ed47f6">_FrontEdgeB</a>;
<a name="l00434"></a>00434     _BackEdgeA = iBrother.<a class="code" href="classTVertex.html#e05f2b15a60575b2f3e53ca1ffcb46ab">_BackEdgeA</a>;
<a name="l00435"></a>00435     _BackEdgeB = iBrother.<a class="code" href="classTVertex.html#5e453c75d45de329a8d4b9bf6cbf8ea9">_BackEdgeB</a>;
<a name="l00436"></a>00436     _sortedEdges = iBrother.<a class="code" href="classTVertex.html#a76077300a867612496a2a3505e7bb4c">_sortedEdges</a>;
<a name="l00437"></a>00437   }
<a name="l00438"></a>00438 
<a name="l00440"></a><a class="code" href="classTVertex.html#76a098db57047010940f5d5f71970f01">00440</a>   <span class="keyword">virtual</span> ViewVertex * <a class="code" href="classViewVertex.html#6a955819f2905fb09ced40d7393db1ed">dupplicate</a>()
<a name="l00441"></a>00441   {
<a name="l00442"></a>00442     TVertex *clone = <span class="keyword">new</span> TVertex(*<span class="keyword">this</span>);
<a name="l00443"></a>00443     <span class="keywordflow">return</span> clone;
<a name="l00444"></a>00444   }
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 <span class="keyword">public</span>:
<a name="l00447"></a>00447   <span class="comment">/* accessors */</span>
<a name="l00449"></a><a class="code" href="classTVertex.html#01d2065cd817138de39a6bbbbb776494">00449</a>   <span class="keyword">inline</span> <a class="code" href="classSVertex.html">SVertex</a>  *frontSVertex() {<span class="keywordflow">return</span> _FrontSVertex;}
<a name="l00451"></a><a class="code" href="classTVertex.html#6d7bc065f69aa7a06ba8d8a41c202d4d">00451</a>   <span class="keyword">inline</span> <a class="code" href="classSVertex.html">SVertex</a>  *backSVertex() {<span class="keywordflow">return</span> _BackSVertex;}
<a name="l00452"></a>00452   <span class="keyword">inline</span> directedViewEdge&amp; frontEdgeA() {<span class="keywordflow">return</span> _FrontEdgeA;}
<a name="l00453"></a>00453   <span class="keyword">inline</span> directedViewEdge&amp; frontEdgeB() {<span class="keywordflow">return</span> _FrontEdgeB;}
<a name="l00454"></a>00454   <span class="keyword">inline</span> directedViewEdge&amp; backEdgeA() {<span class="keywordflow">return</span> _BackEdgeA;}
<a name="l00455"></a>00455   <span class="keyword">inline</span> directedViewEdge&amp; backEdgeB() {<span class="keywordflow">return</span> _BackEdgeB;}
<a name="l00456"></a>00456   
<a name="l00457"></a>00457   <span class="comment">/* modifiers */</span>
<a name="l00459"></a><a class="code" href="classTVertex.html#b6f0a0cb1f9f71e049dca3750db6f905">00459</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetFrontVertex(<a class="code" href="classSVertex.html">SVertex</a>  *iFrontSVertex) {_FrontSVertex = iFrontSVertex;_FrontSVertex-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);}
<a name="l00461"></a><a class="code" href="classTVertex.html#32cab01d66f0ff074e713ba817ec8315">00461</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetBackSVertex(<a class="code" href="classSVertex.html">SVertex</a>  *iBackSVertex) {_BackSVertex = iBackSVertex;_BackSVertex-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);}
<a name="l00462"></a>00462   <span class="keywordtype">void</span> SetFrontEdgeA(<a class="code" href="classViewEdge.html">ViewEdge</a> *iFrontEdgeA, <span class="keywordtype">bool</span> incoming=<span class="keyword">true</span>);
<a name="l00463"></a>00463   <span class="keywordtype">void</span> SetFrontEdgeB(<a class="code" href="classViewEdge.html">ViewEdge</a> *iFrontEdgeB, <span class="keywordtype">bool</span> incoming=<span class="keyword">true</span>) ;
<a name="l00464"></a>00464   <span class="keywordtype">void</span> SetBackEdgeA(<a class="code" href="classViewEdge.html">ViewEdge</a> *iBackEdgeA, <span class="keywordtype">bool</span> incoming=<span class="keyword">true</span>);
<a name="l00465"></a>00465   <span class="keywordtype">void</span> SetBackEdgeB(<a class="code" href="classViewEdge.html">ViewEdge</a> *iBackEdgeB, <span class="keywordtype">bool</span> incoming=<span class="keyword">true</span>) ;
<a name="l00467"></a><a class="code" href="classTVertex.html#7b33ce0b21d97c7ee2ca4577c7005dc3">00467</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetId(<span class="keyword">const</span> <a class="code" href="classId.html">Id</a>&amp; iId) {_Id = iId;}
<a name="l00468"></a>00468   
<a name="l00470"></a><a class="code" href="classTVertex.html#048108f5ea022b05fcf4369fec1604b6">00470</a>   <span class="keyword">inline</span> <a class="code" href="classSVertex.html">SVertex</a> * GetSVertex(<a class="code" href="classFEdge.html">FEdge</a> *iFEdge)
<a name="l00471"></a>00471   {
<a name="l00472"></a>00472     <span class="keyword">const</span> vector&lt;FEdge*&gt;&amp; vfEdges = _FrontSVertex-&gt;fedges();
<a name="l00473"></a>00473     vector&lt;FEdge*&gt;::const_iterator fe,fend;
<a name="l00474"></a>00474     <span class="keywordflow">for</span>(fe=vfEdges.begin(),fend=vfEdges.end();
<a name="l00475"></a>00475     fe!=fend;
<a name="l00476"></a>00476     fe++)
<a name="l00477"></a>00477     {
<a name="l00478"></a>00478       <span class="keywordflow">if</span>((*fe) == iFEdge)
<a name="l00479"></a>00479         <span class="keywordflow">return</span> _FrontSVertex;
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482     <span class="keyword">const</span> vector&lt;FEdge*&gt;&amp; vbEdges = _BackSVertex-&gt;fedges();
<a name="l00483"></a>00483     <span class="keywordflow">for</span>(fe=vbEdges.begin(),fend=vbEdges.end();
<a name="l00484"></a>00484     fe!=fend;
<a name="l00485"></a>00485     fe++)
<a name="l00486"></a>00486     {
<a name="l00487"></a>00487       <span class="keywordflow">if</span>((*fe) == iFEdge)
<a name="l00488"></a>00488         <span class="keywordflow">return</span> _BackSVertex;
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490     <span class="keywordflow">return</span> 0;
<a name="l00491"></a>00491   }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Replace(<a class="code" href="classViewEdge.html">ViewEdge</a> *iOld, <a class="code" href="classViewEdge.html">ViewEdge</a> *iNew);
<a name="l00494"></a>00494   
<a name="l00501"></a><a class="code" href="classTVertex.html#b39287ebc50f23e5ae380c0eaa5721a3">00501</a>   <span class="keyword">virtual</span> <a class="code" href="classViewEdge.html">ViewEdge</a> * mate(<a class="code" href="classViewEdge.html">ViewEdge</a>* iEdgeA)
<a name="l00502"></a>00502   {
<a name="l00503"></a>00503     <span class="keywordflow">if</span>(iEdgeA == _FrontEdgeA.first)
<a name="l00504"></a>00504       <span class="keywordflow">return</span> _FrontEdgeB.first;
<a name="l00505"></a>00505     <span class="keywordflow">if</span>(iEdgeA == _FrontEdgeB.first)
<a name="l00506"></a>00506       <span class="keywordflow">return</span> _FrontEdgeA.first;
<a name="l00507"></a>00507     <span class="keywordflow">if</span>(iEdgeA == _BackEdgeA.first)
<a name="l00508"></a>00508       <span class="keywordflow">return</span> _BackEdgeB.first;
<a name="l00509"></a>00509     <span class="keywordflow">if</span>(iEdgeA == _BackEdgeB.first)
<a name="l00510"></a>00510       <span class="keywordflow">return</span> _BackEdgeA.first;
<a name="l00511"></a>00511     <span class="keywordflow">return</span> 0;
<a name="l00512"></a>00512   }
<a name="l00513"></a>00513   
<a name="l00514"></a>00514   <span class="comment">/* iterators access */</span>
<a name="l00515"></a>00515   <span class="keyword">virtual</span> edge_iterator edges_begin();
<a name="l00516"></a>00516   <span class="keyword">virtual</span> const_edge_iterator edges_begin() <span class="keyword">const</span>;
<a name="l00517"></a>00517   <span class="keyword">virtual</span> edge_iterator edges_end();
<a name="l00518"></a>00518   <span class="keyword">virtual</span> const_edge_iterator edges_end() <span class="keyword">const</span>;
<a name="l00519"></a>00519   <span class="keyword">virtual</span> edge_iterator edges_iterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge);
<a name="l00520"></a>00520   <span class="keyword">virtual</span> const_edge_iterator edges_iterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) <span class="keyword">const</span>;
<a name="l00521"></a>00521 
<a name="l00527"></a>00527   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> <a class="code" href="classViewVertex.html#834c9ee549fad65ba60ed90d2139ee0d">edgesBegin</a>() ;
<a name="l00531"></a>00531   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> <a class="code" href="classViewVertex.html#624eea5d670520e8c2e79ad2f960b0b7">edgesEnd</a>() ;
<a name="l00535"></a>00535   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> <a class="code" href="classViewVertex.html#186571a6cd5183696b000bc46c4252ec">edgesIterator</a>(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) ;
<a name="l00536"></a>00536 };
<a name="l00537"></a>00537 
<a name="l00538"></a>00538 
<a name="l00539"></a>00539                   <span class="comment">/**********************************/</span>
<a name="l00540"></a>00540                   <span class="comment">/*                                */</span>
<a name="l00541"></a>00541                   <span class="comment">/*                                */</span>
<a name="l00542"></a>00542                   <span class="comment">/*             NonTVertex         */</span> 
<a name="l00543"></a>00543                   <span class="comment">/*                                */</span>
<a name="l00544"></a>00544                   <span class="comment">/*                                */</span>
<a name="l00545"></a>00545                   <span class="comment">/**********************************/</span>
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 
<a name="l00548"></a>00548 <span class="comment">// (non T vertex)</span>
<a name="l00553"></a><a class="code" href="classNonTVertex.html">00553</a> <span class="comment"></span><span class="keyword">class </span>LIB_VIEW_MAP_EXPORT NonTVertex : <span class="keyword">public</span> ViewVertex
<a name="l00554"></a>00554 {
<a name="l00555"></a>00555 <span class="keyword">public</span>:
<a name="l00556"></a>00556   <span class="keyword">typedef</span> vector&lt;directedViewEdge&gt; edges_container;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558 <span class="keyword">public</span>: <span class="comment">// Implementation of Interface0D</span>
<a name="l00559"></a>00559 
<a name="l00561"></a><a class="code" href="classNonTVertex.html#002b7eb8fd08613c974586b621ff2636">00561</a>   <span class="keyword">virtual</span> string <a class="code" href="classViewVertex.html#002b7eb8fd08613c974586b621ff2636">getExactTypeName</a>()<span class="keyword"> const </span>{
<a name="l00562"></a>00562     <span class="keywordflow">return</span> <span class="stringliteral">"NonTVertex"</span>;
<a name="l00563"></a>00563   }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565   <span class="comment">// Data access methods</span>
<a name="l00567"></a><a class="code" href="classNonTVertex.html#274823147ae3fafce59cbe9fb6dec08a">00567</a> <span class="comment"></span>  <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#274823147ae3fafce59cbe9fb6dec08a">getX</a>()<span class="keyword"> const </span>{
<a name="l00568"></a>00568     <span class="keywordflow">return</span> _SVertex-&gt;point3D().x();
<a name="l00569"></a>00569   }
<a name="l00571"></a><a class="code" href="classNonTVertex.html#f7e41b0ea9c10ae3bb6ffba615a82628">00571</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#f7e41b0ea9c10ae3bb6ffba615a82628">getY</a>()<span class="keyword"> const </span>{
<a name="l00572"></a>00572     <span class="keywordflow">return</span> _SVertex-&gt;point3D().y();
<a name="l00573"></a>00573   }
<a name="l00574"></a>00574 
<a name="l00576"></a><a class="code" href="classNonTVertex.html#054421e6b566c6b515370982bbabbaef">00576</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#054421e6b566c6b515370982bbabbaef">getZ</a>()<span class="keyword"> const </span>{
<a name="l00577"></a>00577     <span class="keywordflow">return</span> _SVertex-&gt;point3D().z();
<a name="l00578"></a>00578   }
<a name="l00579"></a>00579 
<a name="l00581"></a><a class="code" href="classNonTVertex.html#a63f0103f8f30be8036639e5d7cf25b4">00581</a>   <span class="keyword">virtual</span> Vec3f <a class="code" href="classInterface0D.html#4f6735c8455c5abc8ef0b6fcd47043df">getPoint3D</a>()<span class="keyword"> const </span>{
<a name="l00582"></a>00582     <span class="keywordflow">return</span> _SVertex-&gt;getPoint3D();
<a name="l00583"></a>00583   }
<a name="l00584"></a>00584 
<a name="l00586"></a><a class="code" href="classNonTVertex.html#63f087d35a11d5c70d60ad8afec7643a">00586</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#63f087d35a11d5c70d60ad8afec7643a">getProjectedX</a>()<span class="keyword"> const </span>{
<a name="l00587"></a>00587     <span class="keywordflow">return</span> _SVertex-&gt;point2D().x();
<a name="l00588"></a>00588   }
<a name="l00589"></a>00589 
<a name="l00591"></a><a class="code" href="classNonTVertex.html#d7dd5911b8a5c6631001e380fcc83b99">00591</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#d7dd5911b8a5c6631001e380fcc83b99">getProjectedY</a>()<span class="keyword"> const </span>{
<a name="l00592"></a>00592     <span class="keywordflow">return</span> _SVertex-&gt;point2D().y();
<a name="l00593"></a>00593   }
<a name="l00594"></a>00594 
<a name="l00596"></a><a class="code" href="classNonTVertex.html#873f09cb4e7b1a4da69d7310686b57f0">00596</a>   <span class="keyword">virtual</span> real <a class="code" href="classInterface0D.html#873f09cb4e7b1a4da69d7310686b57f0">getProjectedZ</a>()<span class="keyword"> const </span>{
<a name="l00597"></a>00597     <span class="keywordflow">return</span> _SVertex-&gt;point2D().z();
<a name="l00598"></a>00598   }
<a name="l00599"></a>00599 
<a name="l00601"></a><a class="code" href="classNonTVertex.html#d1dd891e64a6b7c555bc0f7a6b61f809">00601</a>   <span class="keyword">virtual</span> Vec2f <a class="code" href="classInterface0D.html#387721134bb87d1fc375cd0416815e8d">getPoint2D</a>()<span class="keyword"> const </span>{
<a name="l00602"></a>00602     <span class="keywordflow">return</span> _SVertex-&gt;getPoint2D();
<a name="l00603"></a>00603   }
<a name="l00604"></a>00604 
<a name="l00606"></a><a class="code" href="classNonTVertex.html#67c9cf6326a694c4b411a2b32c90c56f">00606</a>   <span class="keyword">virtual</span> <a class="code" href="classId.html">Id</a> <a class="code" href="classInterface0D.html#67c9cf6326a694c4b411a2b32c90c56f">getId</a>()<span class="keyword"> const </span>{
<a name="l00607"></a>00607     <span class="keywordflow">return</span> _SVertex-&gt;getId();
<a name="l00608"></a>00608   }
<a name="l00609"></a>00609 
<a name="l00611"></a><a class="code" href="classNonTVertex.html#5a6b32ed4feeed6bcb90ae8b3549b347">00611</a>   <span class="keyword">virtual</span> <a class="code" href="classSVertex.html">SVertex</a> * <a class="code" href="classInterface0D.html#5a6b32ed4feeed6bcb90ae8b3549b347">castToSVertex</a>(){
<a name="l00612"></a>00612     <span class="keywordflow">return</span> _SVertex;
<a name="l00613"></a>00613   }
<a name="l00614"></a>00614 
<a name="l00616"></a><a class="code" href="classNonTVertex.html#a3037f6ca1e9a4d67b6b707e595db5d1">00616</a>   <span class="keyword">virtual</span> ViewVertex * <a class="code" href="classInterface0D.html#a3037f6ca1e9a4d67b6b707e595db5d1">castToViewVertex</a>(){
<a name="l00617"></a>00617     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00618"></a>00618   }
<a name="l00619"></a>00619 
<a name="l00621"></a><a class="code" href="classNonTVertex.html#2e7defc35c0da9c275bbc2c0ed1e60e9">00621</a>   <span class="keyword">virtual</span> NonTVertex * <a class="code" href="classInterface0D.html#2e7defc35c0da9c275bbc2c0ed1e60e9">castToNonTVertex</a>(){
<a name="l00622"></a>00622     <span class="keywordflow">return</span> <span class="keyword">this</span>;
<a name="l00623"></a>00623   }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="keyword">private</span>:
<a name="l00626"></a>00626   <a class="code" href="classSVertex.html">SVertex</a> *_SVertex;
<a name="l00627"></a>00627   edges_container _ViewEdges; 
<a name="l00628"></a>00628 <span class="keyword">public</span>:
<a name="l00630"></a><a class="code" href="classNonTVertex.html#1521e0276942e7228d7e42a2235887cf">00630</a>   <span class="keyword">inline</span> NonTVertex() : ViewVertex(Nature::NON_T_VERTEX) { _SVertex = 0; }
<a name="l00632"></a><a class="code" href="classNonTVertex.html#da78068daf9b3818bca59bafc3055f7a">00632</a>   <span class="keyword">inline</span> NonTVertex(<a class="code" href="classSVertex.html">SVertex</a>* iSVertex) : ViewVertex(Nature::NON_T_VERTEX)
<a name="l00633"></a>00633   {
<a name="l00634"></a>00634     _SVertex = iSVertex;
<a name="l00635"></a>00635     _SVertex-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);
<a name="l00636"></a>00636   }
<a name="l00637"></a>00637 <span class="keyword">protected</span>:
<a name="l00639"></a><a class="code" href="classNonTVertex.html#6fb275d8794a874bf7dd4643a435d6f9">00639</a>   <span class="keyword">inline</span> NonTVertex(NonTVertex&amp; iBrother)
<a name="l00640"></a>00640     : ViewVertex(iBrother)
<a name="l00641"></a>00641   {
<a name="l00642"></a>00642     _SVertex = iBrother.<a class="code" href="classNonTVertex.html#a02bee734ef606c0b0015f869b524eed">_SVertex</a>;
<a name="l00643"></a>00643     _SVertex-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);
<a name="l00644"></a>00644     _ViewEdges = iBrother.<a class="code" href="classNonTVertex.html#176870709e7120625da3d24821a9ac93">_ViewEdges</a>;
<a name="l00645"></a>00645   }
<a name="l00647"></a><a class="code" href="classNonTVertex.html#76a098db57047010940f5d5f71970f01">00647</a>   <span class="keyword">virtual</span> ViewVertex * <a class="code" href="classViewVertex.html#6a955819f2905fb09ced40d7393db1ed">dupplicate</a>()
<a name="l00648"></a>00648   {
<a name="l00649"></a>00649     NonTVertex *clone = <span class="keyword">new</span> NonTVertex(*<span class="keyword">this</span>);
<a name="l00650"></a>00650     <span class="keywordflow">return</span> clone;
<a name="l00651"></a>00651   }
<a name="l00652"></a>00652 <span class="keyword">public</span>:
<a name="l00654"></a><a class="code" href="classNonTVertex.html#cc34571f7ae753eed69375267fcea11d">00654</a>   <span class="keyword">virtual</span> ~NonTVertex() {}
<a name="l00655"></a>00655   
<a name="l00656"></a>00656   <span class="comment">/* accessors */</span>
<a name="l00658"></a><a class="code" href="classNonTVertex.html#0344ef04792fa1fdd8a2750a635d7942">00658</a>   <span class="keyword">inline</span> <a class="code" href="classSVertex.html">SVertex</a> * svertex() {<span class="keywordflow">return</span> _SVertex;}
<a name="l00659"></a>00659   <span class="keyword">inline</span> edges_container&amp; viewedges() {<span class="keywordflow">return</span> _ViewEdges;}
<a name="l00660"></a>00660   
<a name="l00661"></a>00661   <span class="comment">/* modifiers */</span>
<a name="l00663"></a><a class="code" href="classNonTVertex.html#c23dbad59325a2d8a85afca21629d6a5">00663</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetSVertex(<a class="code" href="classSVertex.html">SVertex</a> *iSVertex) {_SVertex = iSVertex;_SVertex-&gt;<a class="code" href="classSVertex.html#7fcbb1fdf8172444feb52dc6547abbb9">SetViewVertex</a>(<span class="keyword">this</span>);}
<a name="l00664"></a>00664   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetViewEdges(<span class="keyword">const</span> vector&lt;directedViewEdge&gt;&amp; iViewEdges) {_ViewEdges = iViewEdges;}
<a name="l00665"></a>00665   <span class="keywordtype">void</span> AddIncomingViewEdge(<a class="code" href="classViewEdge.html">ViewEdge</a> * iVEdge) ;
<a name="l00666"></a>00666   <span class="keywordtype">void</span> AddOutgoingViewEdge(<a class="code" href="classViewEdge.html">ViewEdge</a> * iVEdge) ;
<a name="l00667"></a>00667   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddViewEdge(<a class="code" href="classViewEdge.html">ViewEdge</a> * iVEdge, <span class="keywordtype">bool</span> incoming=<span class="keyword">true</span>) {
<a name="l00668"></a>00668     <span class="keywordflow">if</span>(incoming)
<a name="l00669"></a>00669       AddIncomingViewEdge(iVEdge);
<a name="l00670"></a>00670     <span class="keywordflow">else</span>
<a name="l00671"></a>00671       AddOutgoingViewEdge(iVEdge);
<a name="l00672"></a>00672   }
<a name="l00673"></a>00673   <span class="comment">/* Replaces old edge by new edge */</span>
<a name="l00674"></a>00674   <span class="keyword">virtual</span> <span class="keywordtype">void</span> Replace(<a class="code" href="classViewEdge.html">ViewEdge</a> *iOld, <a class="code" href="classViewEdge.html">ViewEdge</a> *iNew)
<a name="l00675"></a>00675   {
<a name="l00676"></a>00676     
<a name="l00677"></a>00677       edges_container::iterator insertedve;
<a name="l00678"></a>00678       <span class="keywordflow">for</span>(edges_container::iterator ve=_ViewEdges.begin(),vend=_ViewEdges.end();
<a name="l00679"></a>00679       ve!=vend;
<a name="l00680"></a>00680       ve++)
<a name="l00681"></a>00681       {
<a name="l00682"></a>00682         <span class="keywordflow">if</span>((ve)-&gt;first == iOld)
<a name="l00683"></a>00683         {
<a name="l00684"></a>00684           insertedve = _ViewEdges.insert(ve, directedViewEdge(iNew, ve-&gt;second));<span class="comment">// inserts e2 before ve.</span>
<a name="l00685"></a>00685                                               <span class="comment">// returns an iterator pointing toward e2. ve is invalidated.</span>
<a name="l00686"></a>00686           <span class="comment">// we want to remove e1, but we can't use ve anymore:</span>
<a name="l00687"></a>00687           insertedve++; <span class="comment">// insertedve points now to e1</span>
<a name="l00688"></a>00688           _ViewEdges.erase(insertedve);
<a name="l00689"></a>00689           <span class="keywordflow">return</span>;
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691       } 
<a name="l00692"></a>00692   }    
<a name="l00693"></a>00693 
<a name="l00694"></a>00694   
<a name="l00695"></a>00695   <span class="comment">/* iterators access */</span>
<a name="l00696"></a>00696   <span class="keyword">virtual</span> edge_iterator edges_begin();
<a name="l00697"></a>00697   <span class="keyword">virtual</span> const_edge_iterator edges_begin() <span class="keyword">const</span>;
<a name="l00698"></a>00698   <span class="keyword">virtual</span> edge_iterator edges_end();
<a name="l00699"></a>00699   <span class="keyword">virtual</span> const_edge_iterator edges_end() <span class="keyword">const</span>;
<a name="l00700"></a>00700   <span class="keyword">virtual</span> edge_iterator edges_iterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge);
<a name="l00701"></a>00701   <span class="keyword">virtual</span> const_edge_iterator edges_iterator(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) <span class="keyword">const</span>;
<a name="l00702"></a>00702 
<a name="l00708"></a>00708   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> <a class="code" href="classViewVertex.html#834c9ee549fad65ba60ed90d2139ee0d">edgesBegin</a>() ;
<a name="l00712"></a>00712   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> <a class="code" href="classViewVertex.html#624eea5d670520e8c2e79ad2f960b0b7">edgesEnd</a>() ;
<a name="l00716"></a>00716   <span class="keyword">virtual</span> <a class="code" href="classViewVertexInternal_1_1orientedViewEdgeIterator.html">ViewVertexInternal::orientedViewEdgeIterator</a> <a class="code" href="classViewVertex.html#186571a6cd5183696b000bc46c4252ec">edgesIterator</a>(<a class="code" href="classViewEdge.html">ViewEdge</a> *iEdge) ;
<a name="l00717"></a>00717 };
<a name="l00718"></a>00718 
<a name="l00719"></a>00719                   <span class="comment">/**********************************/</span>
<a name="l00720"></a>00720                   <span class="comment">/*                                */</span>
<a name="l00721"></a>00721                   <span class="comment">/*                                */</span>
<a name="l00722"></a>00722                   <span class="comment">/*             ViewEdge           */</span>
<a name="l00723"></a>00723                   <span class="comment">/*                                */</span>
<a name="l00724"></a>00724                   <span class="comment">/*                                */</span>
<a name="l00725"></a>00725                   <span class="comment">/**********************************/</span>
<a name="l00726"></a>00726 
<a name="l00727"></a>00727 <span class="comment">/* Geometry(normals...)</span>
<a name="l00728"></a>00728 <span class="comment">  Nature of edges</span>
<a name="l00729"></a>00729 <span class="comment">  2D spaces (1or2, material, z...)</span>
<a name="l00730"></a>00730 <span class="comment">  Parent Shape</span>
<a name="l00731"></a>00731 <span class="comment">  3D Shading, material</span>
<a name="l00732"></a>00732 <span class="comment">  Importance</span>
<a name="l00733"></a>00733 <span class="comment">  Occluders</span>
<a name="l00734"></a>00734 <span class="comment">  */</span>
<a name="l00735"></a>00735 <span class="keyword">class </span><a class="code" href="classViewShape.html">ViewShape</a>;
<a name="l00736"></a>00736 
<a name="l00737"></a>00737 <span class="keyword">namespace </span>ViewEdgeInternal {
<a name="l00738"></a>00738   <span class="keyword">template</span>&lt;<span class="keyword">class</span> Traits&gt; <span class="keyword">class </span>edge_iterator_base ;
<a name="l00739"></a>00739   <span class="keyword">template</span>&lt;<span class="keyword">class</span> Traits&gt; <span class="keyword">class </span>fedge_iterator_base ;
<a name="l00740"></a>00740   <span class="keyword">template</span>&lt;<span class="keyword">class</span> Traits&gt; <span class="keyword">class </span>vertex_iterator_base ;
<a name="l00741"></a>00741 } <span class="comment">// end of namespace ViewEdgeInternal</span>
<a name="l00742"></a>00742 
<a name="l00747"></a><a class="code" href="classViewEdge.html">00747</a> <span class="keyword">class </span>LIB_VIEW_MAP_EXPORT ViewEdge : <span class="keyword">public</span> <a class="code" href="classInterface1D.html">Interface1D</a>
<a name="l00748"></a>00748 {
<a name="l00749"></a>00749 <span class="keyword">public</span>: <span class="comment">// Implementation of Interface0D</span>
<a name="l00750"></a>00750 
<a name="l00752"></a><a class="code" href="classViewEdge.html#002b7eb8fd08613c974586b621ff2636">00752</a>   <span class="keyword">virtual</span> string <a class="code" href="classInterface1D.html#002b7eb8fd08613c974586b621ff2636">getExactTypeName</a>()<span class="keyword"> const </span>{
<a name="l00753"></a>00753     <span class="keywordflow">return</span> <span class="stringliteral">"ViewEdge"</span>;
<a name="l00754"></a>00754   }
<a name="l00755"></a>00755 
<a name="l00756"></a>00756   <span class="comment">// Data access methods</span>
<a name="l00758"></a><a class="code" href="classViewEdge.html#67c9cf6326a694c4b411a2b32c90c56f">00758</a> <span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classId.html">Id</a> <a class="code" href="classInterface1D.html#67c9cf6326a694c4b411a2b32c90c56f">getId</a>()<span class="keyword"> const </span>{
<a name="l00759"></a>00759     <span class="keywordflow">return</span> _Id;
<a name="l00760"></a>00760   }
<a name="l00761"></a>00761 
<a name="l00763"></a><a class="code" href="classViewEdge.html#4e9afa184b4cabf5b83e9422de62170f">00763</a>   <span class="keyword">virtual</span> Nature::EdgeNature <a class="code" href="classInterface1D.html#4e9afa184b4cabf5b83e9422de62170f">getNature</a>()<span class="keyword"> const </span>{
<a name="l00764"></a>00764     <span class="keywordflow">return</span> _Nature;
<a name="l00765"></a>00765   }
<a name="l00766"></a>00766 
<a name="l00767"></a>00767 <span class="keyword">public</span>:
<a name="l00768"></a>00768   
<a name="l00769"></a>00769   <span class="keyword">typedef</span> <a class="code" href="classSVertex.html">SVertex</a> vertex_type;
<a name="l00770"></a>00770   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classViewShape.html">ViewShape</a>;
<a name="l00771"></a>00771   <span class="comment">// for ViewEdge iterator</span>
<a name="l00772"></a>00772   <span class="keyword">typedef</span> ViewEdgeInternal::edge_iterator_base&lt;Nonconst_traits&lt;ViewEdge*&gt; &gt; edge_iterator;
<a name="l00773"></a>00773   <span class="keyword">typedef</span> ViewEdgeInternal::edge_iterator_base&lt;Const_traits&lt;ViewEdge*&gt; &gt; const_edge_iterator;
<a name="l00774"></a>00774   <span class="comment">// for fedge iterator</span>
<a name="l00775"></a>00775   <span class="keyword">typedef</span> ViewEdgeInternal::fedge_iterator_base&lt;Nonconst_traits&lt;FEdge*&gt; &gt; fedge_iterator;
<a name="l00776"></a>00776   <span class="keyword">typedef</span> ViewEdgeInternal::fedge_iterator_base&lt;Const_traits&lt;FEdge*&gt; &gt; const_fedge_iterator;
<a name="l00777"></a>00777   <span class="comment">// for svertex iterator</span>
<a name="l00778"></a>00778   <span class="keyword">typedef</span> ViewEdgeInternal::vertex_iterator_base&lt;Nonconst_traits&lt;SVertex*&gt; &gt; vertex_iterator;
<a name="l00779"></a>00779   <span class="keyword">typedef</span> ViewEdgeInternal::vertex_iterator_base&lt;Const_traits&lt;SVertex*&gt; &gt; const_vertex_iterator;
<a name="l00780"></a>00780 <span class="keyword">private</span>:
<a name="l00781"></a>00781 
<a name="l00782"></a>00782   ViewVertex * __A; <span class="comment">// edge starting vertex</span>
<a name="l00783"></a>00783   ViewVertex * __B; <span class="comment">// edge ending vertex</span>
<a name="l00784"></a>00784   Nature::EdgeNature _Nature; <span class="comment">// nature of view edge</span>
<a name="l00785"></a>00785   <a class="code" href="classViewShape.html">ViewShape</a> *_Shape; <span class="comment">// shape to which the view edge belongs</span>
<a name="l00786"></a>00786   <a class="code" href="classFEdge.html">FEdge</a> * _FEdgeA; <span class="comment">// first edge of the embedded fedges chain</span>
<a name="l00787"></a>00787   <a class="code" href="classFEdge.html">FEdge</a> * _FEdgeB; <span class="comment">// last edge of the embedded fedges chain</span>
<a name="l00788"></a>00788   <a class="code" href="classId.html">Id</a> _Id;
<a name="l00789"></a>00789   <span class="keywordtype">unsigned</span> _ChainingTimeStamp;
<a name="l00790"></a>00790   <a class="code" href="classViewShape.html">ViewShape</a> *_aShape; <span class="comment">// The silhouette view edge separates 2 2D spaces. The one on the left is </span>
<a name="l00791"></a>00791   <span class="comment">// necessarly the Shape _Shape (the one to which this edge belongs to)</span>
<a name="l00792"></a>00792   <span class="comment">// and _aShape is the one on its right // NON GERE PAR LE COPY CONSTRUCTEUR</span>
<a name="l00793"></a>00793   <span class="keywordtype">int</span> _qi;
<a name="l00794"></a>00794   vector&lt;ViewShape*&gt; _Occluders;
<a name="l00795"></a>00795 
<a name="l00796"></a>00796   <span class="comment">// tmp</span>
<a name="l00797"></a>00797   <a class="code" href="classId.html">Id</a> * _splittingId;
<a name="l00798"></a>00798 
<a name="l00799"></a>00799 <span class="keyword">public</span>:
<a name="l00803"></a><a class="code" href="classViewEdge.html#fd0ffb02780e738d4c0a10ab833b7834">00803</a>   <span class="keywordtype">void</span> * <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a>;
<a name="l00805"></a><a class="code" href="classViewEdge.html#f78400ff2ca3de8bcc1555bf64b5a1ff">00805</a>   <span class="keyword">inline</span> ViewEdge() {
<a name="l00806"></a>00806     __A=0;
<a name="l00807"></a>00807     __B=0;
<a name="l00808"></a>00808     _FEdgeA = 0;
<a name="l00809"></a>00809     _FEdgeB = 0;
<a name="l00810"></a>00810     _ChainingTimeStamp = 0;
<a name="l00811"></a>00811     _qi = 0;
<a name="l00812"></a>00812     _aShape=0;
<a name="l00813"></a>00813     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00814"></a>00814     _splittingId = 0;
<a name="l00815"></a>00815   }
<a name="l00816"></a>00816   <span class="keyword">inline</span> ViewEdge(ViewVertex* iA, ViewVertex *iB)
<a name="l00817"></a>00817   {
<a name="l00818"></a>00818     __A = iA;
<a name="l00819"></a>00819     __B = iB;
<a name="l00820"></a>00820     _FEdgeA = 0;
<a name="l00821"></a>00821     _FEdgeB = 0;
<a name="l00822"></a>00822     _Shape = 0;
<a name="l00823"></a>00823     _ChainingTimeStamp = 0;
<a name="l00824"></a>00824     _aShape = 0;
<a name="l00825"></a>00825     _qi = 0;
<a name="l00826"></a>00826     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00827"></a>00827     _splittingId = 0;
<a name="l00828"></a>00828   }
<a name="l00829"></a>00829   <span class="keyword">inline</span> ViewEdge(ViewVertex* iA, ViewVertex *iB, <a class="code" href="classFEdge.html">FEdge</a> *iFEdgeA)
<a name="l00830"></a>00830   {
<a name="l00831"></a>00831     __A = iA;
<a name="l00832"></a>00832     __B = iB;
<a name="l00833"></a>00833     _FEdgeA = iFEdgeA;
<a name="l00834"></a>00834     _FEdgeB = 0;
<a name="l00835"></a>00835     _Shape = 0;
<a name="l00836"></a>00836     _ChainingTimeStamp = 0;
<a name="l00837"></a>00837     _aShape = 0;
<a name="l00838"></a>00838     _qi = 0;
<a name="l00839"></a>00839     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00840"></a>00840     _splittingId = 0;
<a name="l00841"></a>00841   }
<a name="l00842"></a>00842   <span class="keyword">inline</span> ViewEdge(ViewVertex* iA, ViewVertex *iB, <a class="code" href="classFEdge.html">FEdge</a> *iFEdgeA, <a class="code" href="classFEdge.html">FEdge</a> *iFEdgeB, <a class="code" href="classViewShape.html">ViewShape</a> *iShape)
<a name="l00843"></a>00843   {
<a name="l00844"></a>00844     __A = iA;
<a name="l00845"></a>00845     __B = iB;
<a name="l00846"></a>00846     _FEdgeA = iFEdgeA;
<a name="l00847"></a>00847     _FEdgeB = iFEdgeB;
<a name="l00848"></a>00848     _Shape = iShape;
<a name="l00849"></a>00849     _ChainingTimeStamp = 0;
<a name="l00850"></a>00850     _aShape = 0;
<a name="l00851"></a>00851     _qi = 0;
<a name="l00852"></a>00852     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00853"></a>00853     _splittingId = 0;
<a name="l00854"></a>00854     UpdateFEdges(); <span class="comment">// tells every FEdge between iFEdgeA and iFEdgeB that this is theit ViewEdge</span>
<a name="l00855"></a>00855   }
<a name="l00856"></a>00856 <span class="keyword">protected</span>:
<a name="l00858"></a><a class="code" href="classViewEdge.html#df2628792d801c4d3d5734fbf42a12f6">00858</a>   <span class="keyword">inline</span> ViewEdge(ViewEdge&amp; iBrother)
<a name="l00859"></a>00859   {
<a name="l00860"></a>00860     __A = iBrother.<a class="code" href="classViewEdge.html#c62950bff9bbac1357a1f0b7cd5105a4">__A</a>;
<a name="l00861"></a>00861     __B = iBrother.<a class="code" href="classViewEdge.html#fc1e873e2ee9518eaafa262e15880d0c">__B</a>;
<a name="l00862"></a>00862     _FEdgeA = iBrother.<a class="code" href="classViewEdge.html#9921f2b452bda1f614ea20b782f4c370">_FEdgeA</a>;
<a name="l00863"></a>00863     _FEdgeB = iBrother.<a class="code" href="classViewEdge.html#b94719b4677a84710a0e5ceeeb542b3e">_FEdgeB</a>;
<a name="l00864"></a>00864     _Nature = iBrother.<a class="code" href="classViewEdge.html#48e54f58090c012c68e8161f4f9ea503">_Nature</a>;
<a name="l00865"></a>00865     _Shape = 0;
<a name="l00866"></a>00866     _Id = iBrother.<a class="code" href="classViewEdge.html#990bb362a91873746691d95a510b4acc">_Id</a>;
<a name="l00867"></a>00867     _ChainingTimeStamp = iBrother.<a class="code" href="classViewEdge.html#91a6344cd14cb1b98eb0858166115a93">_ChainingTimeStamp</a>;
<a name="l00868"></a>00868     _aShape = iBrother.<a class="code" href="classViewEdge.html#4a48d126a20cfa45ee43b026b57f95ed">_aShape</a>;
<a name="l00869"></a>00869     _qi = iBrother.<a class="code" href="classViewEdge.html#a4086c9f926357000cf01f6d1b56e006">_qi</a>;
<a name="l00870"></a>00870     _splittingId = 0;
<a name="l00871"></a>00871     iBrother.<a class="code" href="classViewEdge.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = <span class="keyword">this</span>;
<a name="l00872"></a>00872     <a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a> = 0;
<a name="l00873"></a>00873   }
<a name="l00875"></a><a class="code" href="classViewEdge.html#bc8a51f4b067e01291b8dfee9bf1f4a5">00875</a>   <span class="keyword">virtual</span> ViewEdge * <a class="code" href="classViewShape.html#fe290800451bb1e53bf66d442a8a983e">dupplicate</a>()
<a name="l00876"></a>00876   {
<a name="l00877"></a>00877     ViewEdge *clone = <span class="keyword">new</span> ViewEdge(*<span class="keyword">this</span>);
<a name="l00878"></a>00878     <span class="keywordflow">return</span> clone;
<a name="l00879"></a>00879   }
<a name="l00880"></a>00880 
<a name="l00881"></a>00881 <span class="keyword">public</span>:
<a name="l00883"></a><a class="code" href="classViewEdge.html#8d9acd2c97b14b32805a17ffdadcf3f1">00883</a>   <span class="keyword">virtual</span> ~ViewEdge()
<a name="l00884"></a>00884   {
<a name="l00885"></a>00885     <span class="comment">//    if(0 != _aFace)</span>
<a name="l00886"></a>00886     <span class="comment">//    {</span>
<a name="l00887"></a>00887     <span class="comment">//      delete _aFace;</span>
<a name="l00888"></a>00888     <span class="comment">//      _aFace = 0;</span>
<a name="l00889"></a>00889     <span class="comment">//    }</span>
<a name="l00890"></a>00890     <span class="comment">// only the last splitted deletes this id</span>
<a name="l00891"></a>00891     <span class="keywordflow">if</span>(_splittingId){
<a name="l00892"></a>00892       <span class="keywordflow">if</span>(*_splittingId == _Id)
<a name="l00893"></a>00893         <span class="keyword">delete</span> _splittingId;
<a name="l00894"></a>00894     }
<a name="l00895"></a>00895   }
<a name="l00896"></a>00896 
<a name="l00897"></a>00897   <span class="comment">/* accessors */</span>
<a name="l00899"></a><a class="code" href="classViewEdge.html#f82710d8f30ab4b5c31b035d85b8d8b9">00899</a>   <span class="keyword">inline</span>  ViewVertex* A()  {<span class="keywordflow">return</span> __A;}
<a name="l00901"></a><a class="code" href="classViewEdge.html#b10550967c8a075905bd31369f6277e9">00901</a>   <span class="keyword">inline</span>  ViewVertex* B()  {<span class="keywordflow">return</span> __B;}
<a name="l00903"></a><a class="code" href="classViewEdge.html#f32dc9cc071607b64b06de0024022a86">00903</a>   <span class="keyword">inline</span>  <a class="code" href="classFEdge.html">FEdge</a>* fedgeA()  {<span class="keywordflow">return</span> _FEdgeA;}
<a name="l00905"></a><a class="code" href="classViewEdge.html#f2b9cb707fd9cc3b6542f42ed847558e">00905</a>   <span class="keyword">inline</span>  <a class="code" href="classFEdge.html">FEdge</a>* fedgeB()  {<span class="keywordflow">return</span> _FEdgeB;}
<a name="l00907"></a><a class="code" href="classViewEdge.html#420fe17eaeb90d9f116e8c7f9602719d">00907</a>   <span class="keyword">inline</span> <a class="code" href="classViewShape.html">ViewShape</a> * viewShape() {<span class="keywordflow">return</span> _Shape;}
<a name="l00913"></a><a class="code" href="classViewEdge.html#f5e91a98fa83f222c38f75b19a3b17a3">00913</a>   <span class="keyword">inline</span> <a class="code" href="classViewShape.html">ViewShape</a> * aShape() {<span class="keywordflow">return</span> _aShape;}
<a name="l00917"></a><a class="code" href="classViewEdge.html#a4391a4781bebbb4e1343951b6616cd3">00917</a>   <span class="keyword">inline</span> <span class="keywordtype">bool</span> isClosed() 
<a name="l00918"></a>00918   {
<a name="l00919"></a>00919     <span class="keywordflow">if</span>(__B == 0)
<a name="l00920"></a>00920       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00921"></a>00921     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00922"></a>00922   }
<a name="l00924"></a><a class="code" href="classViewEdge.html#d424bedc39f81c45da657360816eac41">00924</a>   <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> getChainingTimeStamp() {<span class="keywordflow">return</span> _ChainingTimeStamp;}
<a name="l00925"></a>00925   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classViewShape.html">ViewShape</a> * aShape()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _aShape;}
<a name="l00926"></a>00926   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classViewShape.html">ViewShape</a> * bShape()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _Shape;}
<a name="l00927"></a>00927   <span class="keyword">inline</span> vector&lt;ViewShape*&gt;&amp; occluders() {<span class="keywordflow">return</span> _Occluders;}
<a name="l00928"></a>00928   <span class="keyword">inline</span> <a class="code" href="classId.html">Id</a> * splittingId() {<span class="keywordflow">return</span> _splittingId;}
<a name="l00929"></a>00929   
<a name="l00930"></a>00930   <span class="comment">/* modifiers */</span>
<a name="l00932"></a><a class="code" href="classViewEdge.html#c77e15b3ab53554089c52f91d6e88af2">00932</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetA(ViewVertex* iA) { __A = iA; }
<a name="l00934"></a><a class="code" href="classViewEdge.html#a162e123d9ff7e584496f71f8c02777a">00934</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetB(ViewVertex* iB) { __B = iB; }
<a name="l00936"></a><a class="code" href="classViewEdge.html#30304d45ddff3272a7496efab801dd83">00936</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetNature(Nature::EdgeNature iNature) { _Nature = iNature; }
<a name="l00938"></a><a class="code" href="classViewEdge.html#688ec7e9b48426a1e37f040db5468c1f">00938</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetFEdgeA(<a class="code" href="classFEdge.html">FEdge</a>* iFEdge) { _FEdgeA = iFEdge; }
<a name="l00940"></a><a class="code" href="classViewEdge.html#49d6062b76571e4fcb8c91e615532de4">00940</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetFEdgeB(<a class="code" href="classFEdge.html">FEdge</a>* iFEdge) { _FEdgeB = iFEdge; }
<a name="l00942"></a><a class="code" href="classViewEdge.html#7aa81c1a31c6823c41d03746e41d4131">00942</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetShape(<a class="code" href="classViewShape.html">ViewShape</a> *iVShape) 
<a name="l00943"></a>00943   {
<a name="l00944"></a>00944     _Shape = iVShape;
<a name="l00945"></a>00945   }
<a name="l00947"></a><a class="code" href="classViewEdge.html#6d8d9b7436118c053c323a4367d70424">00947</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetId(<span class="keyword">const</span> <a class="code" href="classId.html">Id</a>&amp; <span class="keywordtype">id</span>) {_Id = id;}
<a name="l00949"></a>00949   <span class="keywordtype">void</span> UpdateFEdges();
<a name="l00951"></a><a class="code" href="classViewEdge.html#e8f6d2183833d5003a1962fec7ffe66f">00951</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetaShape(<a class="code" href="classViewShape.html">ViewShape</a> * iShape) {_aShape = iShape;}
<a name="l00953"></a><a class="code" href="classViewEdge.html#c136781779115df5e4d696e7bd3e9293">00953</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetQI(<span class="keywordtype">int</span> qi) {_qi = qi;}
<a name="l00955"></a><a class="code" href="classViewEdge.html#78907f489f24029b5dcd9e01f5ba906d">00955</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> setChainingTimeStamp(<span class="keywordtype">unsigned</span> ts) {_ChainingTimeStamp = ts;}
<a name="l00956"></a>00956   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddOccluder(<a class="code" href="classViewShape.html">ViewShape</a> *iShape) {_Occluders.push_back(iShape);}
<a name="l00957"></a>00957   <span class="keyword">inline</span> <span class="keywordtype">void</span> setSplittingId(<a class="code" href="classId.html">Id</a> * <span class="keywordtype">id</span>) {_splittingId = id;}
<a name="l00958"></a>00958 
<a name="l00959"></a>00959   <span class="comment">/* stroke interface definition */</span>
<a name="l00960"></a>00960   <span class="keyword">inline</span> <span class="keywordtype">bool</span> intersect_2d_area(<span class="keyword">const</span> Vec2r&amp; iMin, <span class="keyword">const</span> Vec2r&amp; iMax)<span class="keyword"> const</span>
<a name="l00961"></a>00961 <span class="keyword">  </span>{
<a name="l00962"></a>00962     <span class="comment">// parse edges to check if one of them is intersection the region:</span>
<a name="l00963"></a>00963     <a class="code" href="classFEdge.html">FEdge</a> * current = _FEdgeA;
<a name="l00964"></a>00964     <span class="keywordflow">do</span>
<a name="l00965"></a>00965     {
<a name="l00966"></a>00966       <span class="keywordflow">if</span>(GeomUtils::intersect2dSeg2dArea(iMin,iMax, 
<a name="l00967"></a>00967                                          Vec2r(current-&gt;<a class="code" href="classFEdge.html#93fffa48a5ca729a446882b6fe99edba">vertexA</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[0],current-&gt;<a class="code" href="classFEdge.html#93fffa48a5ca729a446882b6fe99edba">vertexA</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[1]),
<a name="l00968"></a>00968                                          Vec2r(current-&gt;<a class="code" href="classFEdge.html#00458b207b0cc7ae45f26f158088b0b1">vertexB</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[0],current-&gt;<a class="code" href="classFEdge.html#00458b207b0cc7ae45f26f158088b0b1">vertexB</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[1])))
<a name="l00969"></a>00969       
<a name="l00970"></a>00970         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00971"></a>00971       current = current-&gt;<a class="code" href="classFEdge.html#0f051f7f2d16c5abc6a91e0602d4841e">nextEdge</a>();
<a name="l00972"></a>00972     }<span class="keywordflow">while</span>((current != 0) &amp;&amp; (current != _FEdgeA));
<a name="l00973"></a>00973 
<a name="l00974"></a>00974     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00975"></a>00975   }
<a name="l00976"></a>00976   <span class="keyword">inline</span> <span class="keywordtype">bool</span> include_in_2d_area(<span class="keyword">const</span> Vec2r&amp; iMin, <span class="keyword">const</span> Vec2r&amp; iMax)<span class="keyword"> const</span>
<a name="l00977"></a>00977 <span class="keyword">  </span>{
<a name="l00978"></a>00978     <span class="comment">// parse edges to check if all of them are intersection the region:</span>
<a name="l00979"></a>00979     <a class="code" href="classFEdge.html">FEdge</a> * current = _FEdgeA;
<a name="l00980"></a>00980     
<a name="l00981"></a>00981     <span class="keywordflow">do</span>
<a name="l00982"></a>00982     {
<a name="l00983"></a>00983       <span class="keywordflow">if</span>(!GeomUtils::include2dSeg2dArea(iMin,iMax, 
<a name="l00984"></a>00984                                         Vec2r(current-&gt;<a class="code" href="classFEdge.html#93fffa48a5ca729a446882b6fe99edba">vertexA</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[0],current-&gt;<a class="code" href="classFEdge.html#93fffa48a5ca729a446882b6fe99edba">vertexA</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[1]),
<a name="l00985"></a>00985                                         Vec2r(current-&gt;<a class="code" href="classFEdge.html#00458b207b0cc7ae45f26f158088b0b1">vertexB</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[0],current-&gt;<a class="code" href="classFEdge.html#00458b207b0cc7ae45f26f158088b0b1">vertexB</a>()-&gt;<a class="code" href="classSVertex.html#70626b19f52120aaef27d0feda776999">point2D</a>()[1])))
<a name="l00986"></a>00986         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00987"></a>00987       current = current-&gt;<a class="code" href="classFEdge.html#0f051f7f2d16c5abc6a91e0602d4841e">nextEdge</a>();
<a name="l00988"></a>00988     }<span class="keywordflow">while</span>((current != 0) &amp;&amp; (current != _FEdgeA));
<a name="l00989"></a>00989     
<a name="l00990"></a>00990     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00991"></a>00991   }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993   <span class="comment">/* Information access interface */</span>
<a name="l00994"></a>00994   
<a name="l00995"></a>00995   <span class="comment">//inline Nature::EdgeNature viewedge_nature() const {return getNature();}</span>
<a name="l00996"></a>00996   <span class="comment">//float viewedge_length() const ;</span>
<a name="l00998"></a>00998 <span class="comment"></span>  real <a class="code" href="classInterface1D.html#de0358cc652d27bcf526cbe9e527ff0d">getLength2D</a>() <span class="keyword">const</span>;
<a name="l00999"></a>00999   <span class="comment">//inline Material material() const {return _FEdgeA-&gt;vertexA()-&gt;shape()-&gt;material();}</span>
<a name="l01000"></a>01000   <span class="keyword">inline</span> <span class="keywordtype">int</span> qi()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _qi;}
<a name="l01001"></a>01001   <span class="keyword">inline</span> occluder_container::const_iterator occluders_begin()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _Occluders.begin();}
<a name="l01002"></a>01002   <span class="keyword">inline</span> occluder_container::const_iterator occluders_end()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _Occluders.end();}
<a name="l01003"></a>01003   <span class="keyword">inline</span> <span class="keywordtype">int</span> occluders_size()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _Occluders.size();}
<a name="l01004"></a>01004   <span class="keyword">inline</span> <span class="keywordtype">bool</span> occluders_empty()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _Occluders.empty();}
<a name="l01005"></a>01005   <span class="keyword">inline</span> <span class="keyword">const</span> Polygon3r&amp; occludee()<span class="keyword"> const </span>{<span class="keywordflow">return</span> (_FEdgeA-&gt;aFace());}
<a name="l01006"></a>01006   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classSShape.html">SShape</a> * occluded_shape() <span class="keyword">const </span>;
<a name="l01007"></a>01007   <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> occludee_empty()<span class="keyword"> const </span>{<span class="keywordflow">if</span>(_aShape == 0) <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="keywordflow">return</span> <span class="keyword">false</span>;}
<a name="l01008"></a>01008   <span class="comment">//inline real z_discontinuity(int iCombination = 0) const ;</span>
<a name="l01009"></a>01009   <span class="keyword">inline</span> <a class="code" href="classId.html">Id</a> shape_id()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _FEdgeA-&gt;vertexA()-&gt;shape()-&gt;getId();}
<a name="l01010"></a>01010   <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classSShape.html">SShape</a> * shape()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _FEdgeA-&gt;vertexA()-&gt;shape();}
<a name="l01011"></a>01011   <span class="keyword">inline</span> <span class="keywordtype">float</span> shape_importance()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _FEdgeA-&gt;shape_importance();} 
<a name="l01012"></a>01012 
<a name="l01013"></a>01013   <span class="comment">/* iterators access */</span>
<a name="l01014"></a>01014   <span class="comment">// view edge iterator</span>
<a name="l01015"></a>01015   edge_iterator ViewEdge_iterator();
<a name="l01016"></a>01016   const_edge_iterator ViewEdge_iterator() <span class="keyword">const</span>;
<a name="l01017"></a>01017   <span class="comment">// feature edge iterator</span>
<a name="l01018"></a>01018   fedge_iterator fedge_iterator_begin();
<a name="l01019"></a>01019   const_fedge_iterator fedge_iterator_begin() <span class="keyword">const</span>;
<a name="l01020"></a>01020   fedge_iterator fedge_iterator_last();
<a name="l01021"></a>01021   const_fedge_iterator fedge_iterator_last() <span class="keyword">const</span>;
<a name="l01022"></a>01022   fedge_iterator fedge_iterator_end();
<a name="l01023"></a>01023   const_fedge_iterator fedge_iterator_end() <span class="keyword">const</span>;
<a name="l01024"></a>01024   <span class="comment">// embedding vertex iterator</span>
<a name="l01025"></a>01025   const_vertex_iterator vertices_begin() <span class="keyword">const</span>;
<a name="l01026"></a>01026   vertex_iterator vertices_begin();
<a name="l01027"></a>01027   const_vertex_iterator vertices_last() <span class="keyword">const</span>;
<a name="l01028"></a>01028   vertex_iterator vertices_last();
<a name="l01029"></a>01029   const_vertex_iterator vertices_end() <span class="keyword">const</span>;
<a name="l01030"></a>01030   vertex_iterator vertices_end();
<a name="l01031"></a>01031 
<a name="l01032"></a>01032   <span class="comment">// Iterator access (Interface1D)</span>
<a name="l01038"></a>01038 <span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classInterface0DIterator.html">Interface0DIterator</a> <a class="code" href="classInterface1D.html#4458730e2155c35c1b1fa4c311a2ae84">verticesBegin</a>();
<a name="l01044"></a>01044   <span class="keyword">virtual</span> <a class="code" href="classInterface0DIterator.html">Interface0DIterator</a> <a class="code" href="classInterface1D.html#98056338b56441646f2603d7bd9cec6a">verticesEnd</a>();
<a name="l01045"></a>01045 
<a name="l01053"></a>01053   <span class="keyword">virtual</span> <a class="code" href="classInterface0DIterator.html">Interface0DIterator</a> <a class="code" href="classInterface1D.html#86c0dbd5aa633652033069a7b577d83e">pointsBegin</a>(<span class="keywordtype">float</span> t=0.f);
<a name="l01061"></a>01061   <span class="keyword">virtual</span> <a class="code" href="classInterface0DIterator.html">Interface0DIterator</a> <a class="code" href="classInterface1D.html#a935b2752a0817c97414824ff355fbfc">pointsEnd</a>(<span class="keywordtype">float</span> t=0.f);
<a name="l01062"></a>01062 };
<a name="l01063"></a>01063 
<a name="l01064"></a>01064   
<a name="l01065"></a>01065 
<a name="l01066"></a>01066                   <span class="comment">/**********************************/</span>
<a name="l01067"></a>01067                   <span class="comment">/*                                */</span>
<a name="l01068"></a>01068                   <span class="comment">/*                                */</span>
<a name="l01069"></a>01069                   <span class="comment">/*             ViewShape          */</span>
<a name="l01070"></a>01070                   <span class="comment">/*                                */</span>
<a name="l01071"></a>01071                   <span class="comment">/*                                */</span>
<a name="l01072"></a>01072                   <span class="comment">/**********************************/</span>
<a name="l01073"></a>01073 
<a name="l01077"></a><a class="code" href="classViewShape.html">01077</a> <span class="keyword">class </span>LIB_VIEW_MAP_EXPORT ViewShape
<a name="l01078"></a>01078 {
<a name="l01079"></a>01079 <span class="keyword">private</span>:
<a name="l01080"></a>01080   vector&lt;ViewVertex*&gt; _Vertices;
<a name="l01081"></a>01081   vector&lt;ViewEdge*&gt; _Edges;
<a name="l01082"></a>01082   <a class="code" href="classSShape.html">SShape</a> * _SShape;
<a name="l01083"></a>01083   
<a name="l01084"></a>01084 
<a name="l01085"></a>01085 <span class="keyword">public</span>:
<a name="l01089"></a><a class="code" href="classViewShape.html#fd0ffb02780e738d4c0a10ab833b7834">01089</a>   <span class="keywordtype">void</span>* userdata;
<a name="l01091"></a><a class="code" href="classViewShape.html#a9c1cc9a86939a3669069ec70ad287ce">01091</a>   <span class="keyword">inline</span> ViewShape() { userdata = 0; _SShape = 0;}
<a name="l01093"></a><a class="code" href="classViewShape.html#5081bee609dd59d81d861b62af6c08d5">01093</a>   <span class="keyword">inline</span> ViewShape(<a class="code" href="classSShape.html">SShape</a> *iSShape) {userdata = 0; _SShape = iSShape;}<span class="comment">//_SShape-&gt;SetViewShape(this);}</span>
<a name="l01095"></a><a class="code" href="classViewShape.html#0e76206246475c59db633b0ff5f7938c">01095</a> <span class="comment"></span>  <span class="keyword">inline</span> ViewShape(ViewShape&amp; iBrother)
<a name="l01096"></a>01096   {
<a name="l01097"></a>01097     userdata = 0;
<a name="l01098"></a>01098     vector&lt;ViewVertex*&gt;::iterator vv,vvend;
<a name="l01099"></a>01099     vector&lt;ViewEdge*&gt;::iterator ve, veend;
<a name="l01100"></a>01100 
<a name="l01101"></a>01101     _SShape = iBrother.<a class="code" href="classViewShape.html#74bb772b07396be227ac5a30725ed24a">_SShape</a>;
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     vector&lt;ViewVertex*&gt;&amp; vvertices = iBrother.<a class="code" href="classViewShape.html#4545fdaa0df2eded5a4057d3f5a34620">vertices</a>();
<a name="l01104"></a>01104     <span class="comment">// dupplicate vertices</span>
<a name="l01105"></a>01105     <span class="keywordflow">for</span>(vv=vvertices.begin(), vvend=vvertices.end();
<a name="l01106"></a>01106     vv!=vvend;
<a name="l01107"></a>01107     vv++)
<a name="l01108"></a>01108     {
<a name="l01109"></a>01109       ViewVertex * newVertex = (*vv)-&gt;dupplicate();
<a name="l01110"></a>01110       AddVertex(newVertex);
<a name="l01111"></a>01111     }
<a name="l01112"></a>01112 
<a name="l01113"></a>01113     vector&lt;ViewEdge*&gt;&amp; vvedges = iBrother.<a class="code" href="classViewShape.html#66233d2b3f716ad6935d41b38af0f836">edges</a>();
<a name="l01114"></a>01114     <span class="comment">// dupplicate edges</span>
<a name="l01115"></a>01115     <span class="keywordflow">for</span>(ve=vvedges.begin(), veend=vvedges.end();
<a name="l01116"></a>01116     ve!=veend;
<a name="l01117"></a>01117     ve++)
<a name="l01118"></a>01118     {
<a name="l01119"></a>01119       ViewEdge * newEdge = (*ve)-&gt;dupplicate();
<a name="l01120"></a>01120       AddEdge(newEdge); <span class="comment">// here the shape is set as the edge's shape</span>
<a name="l01121"></a>01121     }
<a name="l01122"></a>01122 
<a name="l01123"></a>01123     <span class="comment">//-------------------------</span>
<a name="l01124"></a>01124     <span class="comment">// remap edges in vertices:</span>
<a name="l01125"></a>01125     <span class="comment">//-------------------------</span>
<a name="l01126"></a>01126     <span class="keywordflow">for</span>(vv=_Vertices.begin(), vvend=_Vertices.end();
<a name="l01127"></a>01127     vv!=vvend;
<a name="l01128"></a>01128     vv++)
<a name="l01129"></a>01129     {
<a name="l01130"></a>01130       <span class="keywordflow">switch</span>((*vv)-&gt;getNature())
<a name="l01131"></a>01131       {  
<a name="l01132"></a>01132       <span class="keywordflow">case</span> Nature::T_VERTEX:
<a name="l01133"></a>01133         {
<a name="l01134"></a>01134           TVertex *v = (TVertex*)(*vv);
<a name="l01135"></a>01135           ViewEdge *veFrontA = (ViewEdge*)(v)-&gt;frontEdgeA().first-&gt;userdata;
<a name="l01136"></a>01136           ViewEdge *veFrontB = (ViewEdge*)(v)-&gt;frontEdgeB().first-&gt;userdata;
<a name="l01137"></a>01137           ViewEdge *veBackA = (ViewEdge*)(v)-&gt;backEdgeA().first-&gt;userdata;
<a name="l01138"></a>01138           ViewEdge *veBackB = (ViewEdge*)(v)-&gt;backEdgeB().first-&gt;userdata;
<a name="l01139"></a>01139 
<a name="l01140"></a>01140           v-&gt;SetFrontEdgeA(veFrontA, v-&gt;frontEdgeA().second);
<a name="l01141"></a>01141           v-&gt;SetFrontEdgeB(veFrontB, v-&gt;frontEdgeB().second);
<a name="l01142"></a>01142           v-&gt;SetBackEdgeA(veBackA, v-&gt;backEdgeA().second);
<a name="l01143"></a>01143           v-&gt;SetBackEdgeB(veBackB, v-&gt;backEdgeB().second);
<a name="l01144"></a>01144         }
<a name="l01145"></a>01145         <span class="keywordflow">break</span>;
<a name="l01146"></a>01146       <span class="keywordflow">case</span> Nature::NON_T_VERTEX:
<a name="l01147"></a>01147         {
<a name="l01148"></a>01148           NonTVertex * v = (NonTVertex*)(*vv);
<a name="l01149"></a>01149           vector&lt;ViewVertex::directedViewEdge&gt;&amp; vedges = (v)-&gt;viewedges();
<a name="l01150"></a>01150           vector&lt;ViewVertex::directedViewEdge&gt; newEdges;
<a name="l01151"></a>01151           <span class="keywordflow">for</span>(vector&lt;ViewVertex::directedViewEdge&gt;::iterator ve=vedges.begin(), veend=vedges.end();
<a name="l01152"></a>01152           ve!=veend;
<a name="l01153"></a>01153           ve++)
<a name="l01154"></a>01154           {
<a name="l01155"></a>01155             ViewEdge *current = (ViewEdge*)((ve)-&gt;first)-&gt;<a class="code" href="classFEdge.html#fd0ffb02780e738d4c0a10ab833b7834">userdata</a>;
<a name="l01156"></a>01156             newEdges.push_back(ViewVertex::directedViewEdge(current, ve-&gt;second));
<a name="l01157"></a>01157           }
<a name="l01158"></a>01158           (v)-&gt;SetViewEdges(newEdges);
<a name="l01159"></a>01159         }
<a name="l01160"></a>01160         <span class="keywordflow">break</span>;
<a name="l01161"></a>01161       <span class="keywordflow">default</span>:
<a name="l01162"></a>01162         ;
<a name="l01163"></a>01163       }
<a name="l01164"></a>01164     }
<a name="l01165"></a>01165     
<a name="l01166"></a>01166     <span class="comment">//-------------------------------------</span>
<a name="l01167"></a>01167     <span class="comment">// remap vertices in edges:</span>
<a name="l01168"></a>01168     <span class="comment">//-------------------------------------</span>
<a name="l01169"></a>01169     <span class="keywordflow">for</span>(ve=_Edges.begin(),veend=_Edges.end();
<a name="l01170"></a>01170         ve!=veend;
<a name="l01171"></a>01171         ve++)
<a name="l01172"></a>01172       {
<a name="l01173"></a>01173         (*ve)-&gt;SetA((ViewVertex*)((*ve)-&gt;A()-&gt;userdata));
<a name="l01174"></a>01174         (*ve)-&gt;SetB((ViewVertex*)((*ve)-&gt;B()-&gt;userdata));
<a name="l01175"></a>01175         <span class="comment">//---------------------------------------</span>
<a name="l01176"></a>01176         <span class="comment">// Update all embedded FEdges</span>
<a name="l01177"></a>01177         <span class="comment">//---------------------------------------</span>
<a name="l01178"></a>01178         (*ve)-&gt;UpdateFEdges();
<a name="l01179"></a>01179       }
<a name="l01180"></a>01180     
<a name="l01181"></a>01181     
<a name="l01182"></a>01182     <span class="comment">// reset all brothers userdata to NULL:</span>
<a name="l01183"></a>01183     <span class="comment">//-------------------------------------</span>
<a name="l01184"></a>01184     <span class="comment">//---------</span>
<a name="l01185"></a>01185     <span class="comment">// vertices</span>
<a name="l01186"></a>01186     <span class="comment">//---------</span>
<a name="l01187"></a>01187     <span class="keywordflow">for</span>(vv=vvertices.begin(),vvend=vvertices.end();
<a name="l01188"></a>01188         vv!=vvend;
<a name="l01189"></a>01189         vv++)
<a name="l01190"></a>01190       {
<a name="l01191"></a>01191         (*vv)-&gt;userdata = NULL;
<a name="l01192"></a>01192       }
<a name="l01193"></a>01193 
<a name="l01194"></a>01194     <span class="comment">//------</span>
<a name="l01195"></a>01195     <span class="comment">// edges</span>
<a name="l01196"></a>01196     <span class="comment">//------</span>
<a name="l01197"></a>01197     <span class="keywordflow">for</span>(ve=vvedges.begin(),veend=vvedges.end();
<a name="l01198"></a>01198         ve!=veend;
<a name="l01199"></a>01199         ve++)
<a name="l01200"></a>01200       {
<a name="l01201"></a>01201         (*ve)-&gt;userdata = NULL;
<a name="l01202"></a>01202       }  
<a name="l01203"></a>01203   }
<a name="l01204"></a>01204 
<a name="l01206"></a><a class="code" href="classViewShape.html#fe290800451bb1e53bf66d442a8a983e">01206</a>   <span class="keyword">virtual</span> ViewShape * dupplicate()
<a name="l01207"></a>01207   {
<a name="l01208"></a>01208     ViewShape *clone = <span class="keyword">new</span> ViewShape(*<span class="keyword">this</span>);
<a name="l01209"></a>01209     <span class="keywordflow">return</span> clone;
<a name="l01210"></a>01210   }
<a name="l01211"></a>01211 
<a name="l01213"></a>01213   <span class="keyword">virtual</span> ~ViewShape();
<a name="l01214"></a>01214 
<a name="l01215"></a>01215   <span class="comment">/* splits a view edge into several view edges. </span>
<a name="l01216"></a>01216 <span class="comment">   *    fe</span>
<a name="l01217"></a>01217 <span class="comment">   *      The FEdge that gets splitted</span>
<a name="l01218"></a>01218 <span class="comment">   *    iViewVertices</span>
<a name="l01219"></a>01219 <span class="comment">   *      The view vertices corresponding to the different intersections for the edge fe.</span>
<a name="l01220"></a>01220 <span class="comment">   *      This list need to be sorted such as the first view vertex is the </span>
<a name="l01221"></a>01221 <span class="comment">   *      farther away from fe-&gt;vertexA.</span>
<a name="l01222"></a>01222 <span class="comment">   *    ioNewEdges</span>
<a name="l01223"></a>01223 <span class="comment">   *      The feature edges that are newly created (the initial edges are not </span>
<a name="l01224"></a>01224 <span class="comment">   *      included) are added to this list.</span>
<a name="l01225"></a>01225 <span class="comment">   *    ioNewViewEdges</span>
<a name="l01226"></a>01226 <span class="comment">   *      The view edges that are newly created (the initial edges are not </span>
<a name="l01227"></a>01227 <span class="comment">   *      included) are added to this list.  </span>
<a name="l01228"></a>01228 <span class="comment">   */</span>
<a name="l01229"></a>01229   <span class="keyword">inline</span> <span class="keywordtype">void</span> SplitEdge(<a class="code" href="classFEdge.html">FEdge</a> *fe, 
<a name="l01230"></a>01230                         <span class="keyword">const</span> vector&lt;TVertex*&gt;&amp; iViewVertices, 
<a name="l01231"></a>01231                         vector&lt;FEdge*&gt;&amp; ioNewEdges,
<a name="l01232"></a>01232                         vector&lt;ViewEdge*&gt;&amp; ioNewViewEdges);
<a name="l01233"></a>01233   <span class="comment">/* accessors */</span>
<a name="l01235"></a><a class="code" href="classViewShape.html#8b9c2b056e0e0966d8cba7d11a74f22f">01235</a>   <span class="keyword">inline</span>  <a class="code" href="classSShape.html">SShape</a> * sshape()  {<span class="keywordflow">return</span> _SShape;}
<a name="l01237"></a><a class="code" href="classViewShape.html#8f4b2b4fbeebda23d508de2388d5b516">01237</a>   <span class="keyword">inline</span>  <span class="keyword">const</span> <a class="code" href="classSShape.html">SShape</a> * sshape()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _SShape;}
<a name="l01239"></a><a class="code" href="classViewShape.html#4545fdaa0df2eded5a4057d3f5a34620">01239</a>   <span class="keyword">inline</span>  vector&lt;ViewVertex*&gt;&amp; vertices() {<span class="keywordflow">return</span> _Vertices;}
<a name="l01241"></a><a class="code" href="classViewShape.html#66233d2b3f716ad6935d41b38af0f836">01241</a>   <span class="keyword">inline</span>  vector&lt;ViewEdge*&gt;&amp; edges() {<span class="keywordflow">return</span> _Edges;}
<a name="l01243"></a><a class="code" href="classViewShape.html#3666dd3c70fc6d311ba63c739da27dd1">01243</a>   <span class="keyword">inline</span>  <a class="code" href="classId.html">Id</a> getId()<span class="keyword"> const </span>{<span class="keywordflow">return</span> _SShape-&gt;getId();}
<a name="l01244"></a>01244 
<a name="l01245"></a>01245   <span class="comment">/* modifiers */</span>
<a name="l01247"></a><a class="code" href="classViewShape.html#172a55c32b816903d2e74cf163418328">01247</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetSShape(<a class="code" href="classSShape.html">SShape</a>* iSShape) {_SShape = iSShape;}
<a name="l01249"></a><a class="code" href="classViewShape.html#c5eb2238a7eebba7e6fcbaa1dfc836fa">01249</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetVertices(<span class="keyword">const</span> vector&lt;ViewVertex*&gt;&amp; iVertices) {_Vertices = iVertices;}
<a name="l01251"></a><a class="code" href="classViewShape.html#b79c7b5c5498a551f3da3c2262aa08a9">01251</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> SetEdges(<span class="keyword">const</span> vector&lt;ViewEdge*&gt;&amp; iEdges) {_Edges = iEdges;}
<a name="l01253"></a><a class="code" href="classViewShape.html#50cf3a2b1240f51c1168d3c1544feeb3">01253</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddVertex(ViewVertex *iVertex) 
<a name="l01254"></a>01254   {
<a name="l01255"></a>01255     _Vertices.push_back(iVertex);
<a name="l01256"></a>01256     <span class="comment">//_SShape-&gt;AddNewVertex(iVertex-&gt;svertex());</span>
<a name="l01257"></a>01257   }
<a name="l01259"></a><a class="code" href="classViewShape.html#107f6caa13c14917911c9ca1347f0e6a">01259</a>   <span class="keyword">inline</span> <span class="keywordtype">void</span> AddEdge(ViewEdge *iEdge) 
<a name="l01260"></a>01260   {
<a name="l01261"></a>01261     _Edges.push_back(iEdge);
<a name="l01262"></a>01262     iEdge-&gt;<a class="code" href="classViewEdge.html#7aa81c1a31c6823c41d03746e41d4131">SetShape</a>(<span class="keyword">this</span>);
<a name="l01263"></a>01263     <span class="comment">//_SShape-&gt;AddNewEdge(iEdge-&gt;fedge());</span>
<a name="l01264"></a>01264   }
<a name="l01265"></a>01265 
<a name="l01266"></a>01266   <span class="comment">/* removes the view edge iViewEdge in the </span>
<a name="l01267"></a>01267 <span class="comment">   *  View Shape and the associated FEdge chain entry</span>
<a name="l01268"></a>01268 <span class="comment">   *  in the underlying SShape </span>
<a name="l01269"></a>01269 <span class="comment">   */</span>
<a name="l01270"></a>01270   <span class="keywordtype">void</span> RemoveEdge(ViewEdge * iViewEdge);
<a name="l01271"></a>01271 
<a name="l01272"></a>01272   <span class="comment">/* removes the view vertex iViewVertex in the </span>
<a name="l01273"></a>01273 <span class="comment">   *  View Shape.</span>
<a name="l01274"></a>01274 <span class="comment">   */</span>
<a name="l01275"></a>01275   <span class="keywordtype">void</span> RemoveVertex(ViewVertex * iViewVertex);
<a name="l01276"></a>01276 };
<a name="l01277"></a>01277 
<a name="l01278"></a>01278 
<a name="l01279"></a>01279 
<a name="l01280"></a>01280 <span class="comment">/*</span>
<a name="l01281"></a>01281 <span class="comment">  </span>
<a name="l01282"></a>01282 <span class="comment">  #############################################</span>
<a name="l01283"></a>01283 <span class="comment">  #############################################</span>
<a name="l01284"></a>01284 <span class="comment">  #############################################</span>
<a name="l01285"></a>01285 <span class="comment">  ######                                 ######</span>
<a name="l01286"></a>01286 <span class="comment">  ######   I M P L E M E N T A T I O N   ######</span>
<a name="l01287"></a>01287 <span class="comment">  ######                                 ######</span>
<a name="l01288"></a>01288 <span class="comment">  #############################################</span>
<a name="l01289"></a>01289 <span class="comment">  #############################################</span>
<a name="l01290"></a>01290 <span class="comment">  #############################################</span>
<a name="l01291"></a>01291 <span class="comment">  </span>
<a name="l01292"></a>01292 <span class="comment">*/</span>
<a name="l01293"></a>01293 <span class="comment">/* for inline functions */</span>
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 <span class="keywordtype">void</span> ViewShape::SplitEdge(<a class="code" href="classFEdge.html">FEdge</a> *fe, 
<a name="l01296"></a>01296                         <span class="keyword">const</span> vector&lt;TVertex*&gt;&amp; iViewVertices, 
<a name="l01297"></a>01297                         vector&lt;FEdge*&gt;&amp; ioNewEdges,
<a name="l01298"></a>01298                         vector&lt;ViewEdge*&gt;&amp; ioNewViewEdges)
<a name="l01299"></a>01299 { 
<a name="l01300"></a>01300     ViewEdge *vEdge = fe-&gt;<a class="code" href="classFEdge.html#3eb81c258f1eb2e2d903dc0d1b8e3b66">viewedge</a>();
<a name="l01301"></a>01301 
<a name="l01302"></a>01302     
<a name="l01303"></a>01303     <span class="comment">// We first need to sort the view vertices from farther to closer to fe-&gt;vertexA</span>
<a name="l01304"></a>01304     
<a name="l01305"></a>01305     <a class="code" href="classSVertex.html">SVertex</a> *sv, *sv2; 
<a name="l01306"></a>01306     ViewVertex *vva, *vvb;
<a name="l01307"></a>01307     vector&lt;TVertex*&gt;::const_iterator vv, vvend;
<a name="l01308"></a>01308     <span class="keywordflow">for</span>(vv=iViewVertices.begin(), vvend = iViewVertices.end();
<a name="l01309"></a>01309     vv!=vvend;
<a name="l01310"></a>01310     vv++)
<a name="l01311"></a>01311     {
<a name="l01312"></a>01312       <span class="comment">// Add the viewvertices to the ViewShape</span>
<a name="l01313"></a>01313       <a class="code" href="classViewShape.html#50cf3a2b1240f51c1168d3c1544feeb3">AddVertex</a>((*vv));
<a name="l01314"></a>01314       
<a name="l01315"></a>01315       <span class="comment">// retrieve the correct SVertex from the view vertex</span>
<a name="l01316"></a>01316       <span class="comment">//--------------------------------------------------</span>
<a name="l01317"></a>01317       sv = (*vv)-&gt;frontSVertex();
<a name="l01318"></a>01318       sv2 = (*vv)-&gt;backSVertex();
<a name="l01319"></a>01319 
<a name="l01320"></a>01320       <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="classSVertex.html#c9aad1d3bbb5a3a994f93c0e6b4b3635">shape</a>() != sv2-&gt;<a class="code" href="classSVertex.html#c9aad1d3bbb5a3a994f93c0e6b4b3635">shape</a>())
<a name="l01321"></a>01321       {
<a name="l01322"></a>01322         <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="classSVertex.html#c9aad1d3bbb5a3a994f93c0e6b4b3635">shape</a>() != _SShape)
<a name="l01323"></a>01323           sv = sv2;
<a name="l01324"></a>01324       }
<a name="l01325"></a>01325       <span class="keywordflow">else</span>
<a name="l01326"></a>01326       {
<a name="l01327"></a>01327         <span class="comment">// if the shape is the same we can safely differ </span>
<a name="l01328"></a>01328         <span class="comment">// the two vertices using their ids:</span>
<a name="l01329"></a>01329         <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="classSVertex.html#67c9cf6326a694c4b411a2b32c90c56f">getId</a>() != fe-&gt;<a class="code" href="classFEdge.html#93fffa48a5ca729a446882b6fe99edba">vertexA</a>()-&gt;<a class="code" href="classSVertex.html#67c9cf6326a694c4b411a2b32c90c56f">getId</a>())
<a name="l01330"></a>01330           sv = sv2;
<a name="l01331"></a>01331       }
<a name="l01332"></a>01332       
<a name="l01333"></a>01333       vva = vEdge-&gt;<a class="code" href="classViewEdge.html#f82710d8f30ab4b5c31b035d85b8d8b9">A</a>();
<a name="l01334"></a>01334       vvb = vEdge-&gt;<a class="code" href="classViewEdge.html#b10550967c8a075905bd31369f6277e9">B</a>();
<a name="l01335"></a>01335       
<a name="l01336"></a>01336       <span class="comment">// We split Fedge AB into AA' and A'B. A' and A'B are created.</span>
<a name="l01337"></a>01337       <span class="comment">// AB becomes (address speaking) AA'. B is updated.</span>
<a name="l01338"></a>01338       <span class="comment">//--------------------------------------------------</span>
<a name="l01339"></a>01339       <a class="code" href="classSShape.html">SShape</a> * shape = fe-&gt;<a class="code" href="classFEdge.html#c9aad1d3bbb5a3a994f93c0e6b4b3635">shape</a>();
<a name="l01340"></a>01340       
<a name="l01341"></a>01341       <span class="comment">// a new edge, A'B is created.</span>
<a name="l01342"></a>01342       <a class="code" href="classFEdge.html">FEdge</a> *newEdge = shape-&gt;<a class="code" href="classSShape.html#41b6f88fca34baed074aa167a327c83d">SplitEdgeIn2</a>(fe, sv);
<a name="l01343"></a>01343 
<a name="l01344"></a>01344       ioNewEdges.push_back(newEdge);
<a name="l01345"></a>01345       ViewEdge *newVEdge;
<a name="l01346"></a>01346 
<a name="l01347"></a>01347       <span class="keywordflow">if</span>((vva == 0) || (vvb == 0)) <span class="comment">// that means we're dealing with a closed viewedge (loop)</span>
<a name="l01348"></a>01348       {
<a name="l01349"></a>01349         <span class="comment">// remove the chain that was starting by the fedge A of vEdge (which is different from fe !!!!)</span>
<a name="l01350"></a>01350         shape-&gt;<a class="code" href="classSShape.html#45380b595f8841cc97cdb137cb94bae9">RemoveEdgeFromChain</a>(vEdge-&gt;<a class="code" href="classViewEdge.html#f32dc9cc071607b64b06de0024022a86">fedgeA</a>());
<a name="l01351"></a>01351         <span class="comment">// we set </span>
<a name="l01352"></a>01352         vEdge-&gt;<a class="code" href="classViewEdge.html#c77e15b3ab53554089c52f91d6e88af2">SetA</a>(*vv);
<a name="l01353"></a>01353         vEdge-&gt;<a class="code" href="classViewEdge.html#a162e123d9ff7e584496f71f8c02777a">SetB</a>(*vv);
<a name="l01354"></a>01354         vEdge-&gt;<a class="code" href="classViewEdge.html#688ec7e9b48426a1e37f040db5468c1f">SetFEdgeA</a>(newEdge);
<a name="l01355"></a>01355         <span class="comment">//FEdge *previousEdge = newEdge-&gt;previousEdge();  </span>
<a name="l01356"></a>01356         vEdge-&gt;<a class="code" href="classViewEdge.html#49d6062b76571e4fcb8c91e615532de4">SetFEdgeB</a>(fe);
<a name="l01357"></a>01357         newVEdge = vEdge;
<a name="l01358"></a>01358         vEdge-&gt;<a class="code" href="classViewEdge.html#f32dc9cc071607b64b06de0024022a86">fedgeA</a>()-&gt;<a class="code" href="classFEdge.html#91acf5439e8eae7b557605d364d803ae">SetViewEdge</a>(newVEdge);
<a name="l01359"></a>01359       }
<a name="l01360"></a>01360       <span class="keywordflow">else</span>
<a name="l01361"></a>01361       {
<a name="l01362"></a>01362         
<a name="l01363"></a>01363         <span class="comment">// while we create the view edge, it updates the "ViewEdge" pointer </span>
<a name="l01364"></a>01364         <span class="comment">// of every underlying FEdges to this.</span>
<a name="l01365"></a>01365         newVEdge = <span class="keyword">new</span> ViewEdge((*vv),vvb);<span class="comment">//, newEdge, vEdge-&gt;fedgeB());</span>
<a name="l01366"></a>01366         newVEdge-&gt;<a class="code" href="classViewEdge.html#30304d45ddff3272a7496efab801dd83">SetNature</a>((fe)-&gt;getNature());
<a name="l01367"></a>01367         newVEdge-&gt;<a class="code" href="classViewEdge.html#688ec7e9b48426a1e37f040db5468c1f">SetFEdgeA</a>(newEdge);
<a name="l01368"></a>01368         <span class="comment">//newVEdge-&gt;SetFEdgeB(fe);</span>
<a name="l01369"></a>01369         <span class="comment">// If our original viewedge is made of one FEdge, </span>
<a name="l01370"></a>01370         <span class="comment">// then </span>
<a name="l01371"></a>01371         <span class="keywordflow">if</span>((vEdge-&gt;<a class="code" href="classViewEdge.html#f32dc9cc071607b64b06de0024022a86">fedgeA</a>() == vEdge-&gt;<a class="code" href="classViewEdge.html#f2b9cb707fd9cc3b6542f42ed847558e">fedgeB</a>()) || (fe == vEdge-&gt;<a class="code" href="classViewEdge.html#f2b9cb707fd9cc3b6542f42ed847558e">fedgeB</a>()))
<a name="l01372"></a>01372           newVEdge-&gt;<a class="code" href="classViewEdge.html#49d6062b76571e4fcb8c91e615532de4">SetFEdgeB</a>(newEdge);
<a name="l01373"></a>01373         <span class="keywordflow">else</span>
<a name="l01374"></a>01374           newVEdge-&gt;<a class="code" href="classViewEdge.html#49d6062b76571e4fcb8c91e615532de4">SetFEdgeB</a>(vEdge-&gt;<a class="code" href="classViewEdge.html#f2b9cb707fd9cc3b6542f42ed847558e">fedgeB</a>()); <span class="comment">//MODIF</span>
<a name="l01375"></a>01375 
<a name="l01376"></a>01376         <a class="code" href="classId.html">Id</a> * newId = vEdge-&gt;<a class="code" href="classViewEdge.html#3afb5f49a986f3129039c472dfbfe44c">splittingId</a>();
<a name="l01377"></a>01377         <span class="keywordflow">if</span>(newId == 0){
<a name="l01378"></a>01378           newId = <span class="keyword">new</span> <a class="code" href="classId.html">Id</a>(vEdge-&gt;<a class="code" href="classViewEdge.html#67c9cf6326a694c4b411a2b32c90c56f">getId</a>());
<a name="l01379"></a>01379           vEdge-&gt;<a class="code" href="classViewEdge.html#bfcc45089248b7f72512ac060e4532af">setSplittingId</a>(newId);
<a name="l01380"></a>01380         }
<a name="l01381"></a>01381         newId-&gt;<a class="code" href="classId.html#9ff7c47a1c1693f13a13bc6c2499fe89">setSecond</a>(newId-&gt;<a class="code" href="classId.html#566043dd235c581f92dcd6f3cef6133f">getSecond</a>()+1);
<a name="l01382"></a>01382         newVEdge-&gt;<a class="code" href="classViewEdge.html#6d8d9b7436118c053c323a4367d70424">SetId</a>(*newId);
<a name="l01383"></a>01383         newVEdge-&gt;<a class="code" href="classViewEdge.html#bfcc45089248b7f72512ac060e4532af">setSplittingId</a>(newId);
<a name="l01384"></a>01384         <span class="comment">//        Id id(vEdge-&gt;getId().getFirst(), vEdge-&gt;getId().getSecond()+1);</span>
<a name="l01385"></a>01385         <span class="comment">//        newVEdge-&gt;SetId(vEdge-&gt;getId());</span>
<a name="l01386"></a>01386         <span class="comment">//        vEdge-&gt;SetId(id);</span>
<a name="l01387"></a>01387         
<a name="l01388"></a>01388         <a class="code" href="classViewShape.html#107f6caa13c14917911c9ca1347f0e6a">AddEdge</a>(newVEdge); <span class="comment">// here this shape is set as the edge's shape</span>
<a name="l01389"></a>01389       
<a name="l01390"></a>01390         <span class="comment">// add new edge to the list of new edges passed as argument:</span>
<a name="l01391"></a>01391         ioNewViewEdges.push_back(newVEdge);
<a name="l01392"></a>01392 
<a name="l01393"></a>01393       
<a name="l01394"></a>01394         
<a name="l01395"></a>01395         <span class="keywordflow">if</span>(0 != vvb) 
<a name="l01396"></a>01396           vvb-&gt;<a class="code" href="classViewVertex.html#3719ecddaff159d0a63a8ae444672dc8">Replace</a>((vEdge), newVEdge);
<a name="l01397"></a>01397 
<a name="l01398"></a>01398         <span class="comment">// we split the view edge:</span>
<a name="l01399"></a>01399         vEdge-&gt;SetB((*vv));
<a name="l01400"></a>01400         vEdge-&gt;SetFEdgeB(fe); <span class="comment">//MODIF</span>
<a name="l01401"></a>01401       
<a name="l01402"></a>01402         <span class="comment">// Update fedges so that they point to the new viewedge:</span>
<a name="l01403"></a>01403         newVEdge-&gt;<a class="code" href="classViewEdge.html#000e2c4e35de1c33e7d1bf71c9bdd5c9">UpdateFEdges</a>();
<a name="l01404"></a>01404 
<a name="l01405"></a>01405       }
<a name="l01406"></a>01406       <span class="comment">// check whether this vertex is a front vertex or a back</span>
<a name="l01407"></a>01407       <span class="comment">// one</span>
<a name="l01408"></a>01408       
<a name="l01409"></a>01409       <span class="keywordflow">if</span>(sv == (*vv)-&gt;frontSVertex())
<a name="l01410"></a>01410       { 
<a name="l01411"></a>01411         <span class="comment">// -- View Vertex A' --</span>
<a name="l01412"></a>01412         (*vv)-&gt;SetFrontEdgeA(vEdge, <span class="keyword">true</span>);
<a name="l01413"></a>01413         (*vv)-&gt;SetFrontEdgeB(newVEdge, <span class="keyword">false</span>);
<a name="l01414"></a>01414       }
<a name="l01415"></a>01415       <span class="keywordflow">else</span>
<a name="l01416"></a>01416       {
<a name="l01417"></a>01417         <span class="comment">// -- View Vertex A' --</span>
<a name="l01418"></a>01418         (*vv)-&gt;SetBackEdgeA(vEdge, <span class="keyword">true</span>);
<a name="l01419"></a>01419         (*vv)-&gt;SetBackEdgeB(newVEdge, <span class="keyword">false</span>);
<a name="l01420"></a>01420       }
<a name="l01421"></a>01421     }
<a name="l01422"></a>01422 } 
<a name="l01423"></a>01423     
<a name="l01424"></a>01424                   <span class="comment">/**********************************/</span>
<a name="l01425"></a>01425                   <span class="comment">/*                                */</span>
<a name="l01426"></a>01426                   <span class="comment">/*                                */</span>
<a name="l01427"></a>01427                   <span class="comment">/*             ViewEdge           */</span>
<a name="l01428"></a>01428                   <span class="comment">/*                                */</span>
<a name="l01429"></a>01429                   <span class="comment">/*                                */</span>
<a name="l01430"></a>01430                   <span class="comment">/**********************************/</span>
<a name="l01431"></a>01431 
<a name="l01432"></a>01432                   
<a name="l01433"></a>01433 <span class="comment">// inline Vec3r ViewEdge::orientation2d(int iCombination) const</span>
<a name="l01434"></a>01434 <span class="comment">// {</span>
<a name="l01435"></a>01435 <span class="comment">//  return edge_orientation2d_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01436"></a>01436 <span class="comment">// }</span>
<a name="l01437"></a>01437 
<a name="l01438"></a>01438 <span class="comment">// inline Vec3r  ViewEdge::orientation3d(int iCombination) const</span>
<a name="l01439"></a>01439 <span class="comment">// {</span>
<a name="l01440"></a>01440 <span class="comment">//  return edge_orientation3d_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01441"></a>01441 <span class="comment">// }</span>
<a name="l01442"></a>01442 
<a name="l01443"></a>01443 <span class="comment">// inline real ViewEdge::z_discontinuity(int iCombination) const </span>
<a name="l01444"></a>01444 <span class="comment">// {</span>
<a name="l01445"></a>01445 <span class="comment">//   return z_discontinuity_edge_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01446"></a>01446 <span class="comment">// }</span>
<a name="l01447"></a>01447 
<a name="l01448"></a>01448 <span class="comment">// inline float ViewEdge::local_average_depth(int iCombination ) const</span>
<a name="l01449"></a>01449 <span class="comment">// {</span>
<a name="l01450"></a>01450 <span class="comment">//   return local_average_depth_edge_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01451"></a>01451 <span class="comment">// }</span>
<a name="l01452"></a>01452 
<a name="l01453"></a>01453 <span class="comment">// inline float ViewEdge::local_depth_variance(int iCombination) const </span>
<a name="l01454"></a>01454 <span class="comment">// {</span>
<a name="l01455"></a>01455 <span class="comment">//   return local_depth_variance_edge_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01456"></a>01456 <span class="comment">// }</span>
<a name="l01457"></a>01457 
<a name="l01458"></a>01458 <span class="comment">// inline real ViewEdge::local_average_density(float sigma, int iCombination) const </span>
<a name="l01459"></a>01459 <span class="comment">// {</span>
<a name="l01460"></a>01460 <span class="comment">//   return density_edge_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01461"></a>01461 <span class="comment">// }</span>
<a name="l01462"></a>01462 
<a name="l01463"></a>01463 <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classSShape.html">SShape</a> * ViewEdge::occluded_shape()<span class="keyword"> const </span>
<a name="l01464"></a>01464 <span class="keyword"></span>{
<a name="l01465"></a>01465   <span class="keywordflow">if</span>(0 == _aShape)
<a name="l01466"></a>01466     <span class="keywordflow">return</span> 0;
<a name="l01467"></a>01467   <span class="keywordflow">return</span> _aShape-&gt;<a class="code" href="classViewShape.html#8b9c2b056e0e0966d8cba7d11a74f22f">sshape</a>();
<a name="l01468"></a>01468 }  
<a name="l01469"></a>01469 
<a name="l01470"></a>01470 <span class="comment">// inline Vec3r ViewEdge::curvature2d_as_vector(int iCombination) const </span>
<a name="l01471"></a>01471 <span class="comment">// {</span>
<a name="l01472"></a>01472 <span class="comment">//   return curvature2d_as_vector_edge_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01473"></a>01473 <span class="comment">// }</span>
<a name="l01474"></a>01474 
<a name="l01475"></a>01475 <span class="comment">// inline real ViewEdge::curvature2d_as_angle(int iCombination) const </span>
<a name="l01476"></a>01476 <span class="comment">// {</span>
<a name="l01477"></a>01477 <span class="comment">//   return curvature2d_as_angle_edge_function&lt;ViewEdge&gt;(*this, iCombination);</span>
<a name="l01478"></a>01478 <span class="comment">// }</span>
<a name="l01479"></a>01479 
<a name="l01480"></a>01480 
<a name="l01481"></a>01481 <span class="preprocessor">#endif // VIEWMAP_H</span>
</pre></div></div>
<div align="center">
<div class="brighttitle"><hr/></div>
<div id='Footer'><table width='90%' border='0' class='footer'><tr>
<td align='left'>
Last modified 6 Mar 2008 </td><td align='center'>
<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=124602&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"/></a>

</td>
<td align='right'>&copy; <a href="http://artis.imag.fr/Members/Stephane.Grabli">Stephane Grabli</a></td></tr></table>
</div>
</div>
</body>
</html>
